(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{116:(e,t,a)=>{Promise.resolve().then(a.bind(a,6297))},2383:()=>{},3686:()=>{},6297:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>P});var r=a(5155),s=a(2115),o=a(63),l=a(8525),i=a(5172);let n=e=>{let{title:t,children:a}=e,[o,l]=(0,s.useState)(!0);return(0,r.jsxs)("div",{className:"border border-white/10 rounded-lg sm:rounded-xl overflow-hidden shadow-sm",children:[(0,r.jsxs)("button",{onClick:()=>l(!o),className:"w-full flex justify-between items-center p-3 sm:p-3.5 md:p-4 bg-white/10 hover:bg-white/15 transition-all duration-200 active:bg-white/20",children:[(0,r.jsx)("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-white/90 truncate pr-2",children:t}),(0,r.jsx)("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-white/60 transform transition-transform duration-200 flex-shrink-0 ".concat(o?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),o&&(0,r.jsx)("div",{className:"p-3 sm:p-4 md:p-5 bg-white/5",children:a})]})},c=e=>{let{example:t,onUpdate:a,onRemove:s}=e,o="w-full p-2 bg-white/5 border border-white/10 rounded-md text-white/80 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 text-sm";return(0,r.jsxs)("div",{className:"bg-white/5 p-3 rounded-lg border border-white/10 space-y-2 relative",children:[(0,r.jsx)("button",{onClick:()=>s(t.id),className:"absolute top-2 right-2 text-white/40 hover:text-red-400 transition-colors",title:"Remover Exemplo",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-white/60 mb-1",children:"Usu\xe1rio:"}),(0,r.jsx)("textarea",{value:t.user,onChange:e=>a(t.id,"user",e.target.value),rows:2,className:o,placeholder:"Ex: Qual o pre\xe7o do plano Pro?"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-white/60 mb-1",children:"Agente:"}),(0,r.jsx)("textarea",{value:t.agent,onChange:e=>a(t.id,"agent",e.target.value),rows:3,className:o,placeholder:"Ex: O plano Pro custa $29/m\xeas e inclui todos os recursos avan\xe7ados."})]})]})},d=e=>{let{fluxo:t,onUpdate:a,onRemove:o}=e,[l,i]=(0,s.useState)(!0),n=(e,r)=>{a(t.id,{[e]:r})},c="w-full text-sm p-1 bg-white/5 border border-white/10 rounded focus:ring-1 focus:ring-emerald-500 focus:border-emerald-500";return(0,r.jsxs)("div",{className:"border border-white/10 rounded-lg",children:[(0,r.jsxs)("div",{className:"bg-white/10 p-2 flex justify-between items-center",children:[(0,r.jsx)("input",{type:"text",value:t.nome,onChange:e=>n("nome",e.target.value),className:"bg-transparent font-semibold text-white w-full focus:outline-none"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("button",{onClick:()=>i(!l),className:"p-1 text-white/60 hover:text-white",children:(0,r.jsx)("svg",{className:"w-5 h-5 transition-transform ".concat(l?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}),(0,r.jsx)("button",{onClick:()=>o(t.id),className:"p-1 text-red-400 hover:text-red-300",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),l&&(0,r.jsxs)("div",{className:"p-3 space-y-3 bg-white/5",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-white/60",children:"Tipo"}),(0,r.jsx)("input",{type:"text",value:t.tipoPrompt,onChange:e=>n("tipoPrompt",e.target.value),className:c})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-white/60",children:"Objetivo"}),(0,r.jsx)("input",{type:"text",value:t.objetivo,onChange:e=>n("objetivo",e.target.value),className:c})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-white/60",children:"Base de Conhecimento (RAG)"}),(0,r.jsx)("textarea",{value:t.baseConhecimentoRAG,onChange:e=>n("baseConhecimentoRAG",e.target.value),rows:2,className:c})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-white/60",children:"Exemplos (Few-Shot)"}),(0,r.jsx)("textarea",{value:t.fewShotExamples,onChange:e=>n("fewShotExamples",e.target.value),rows:4,className:c,placeholder:"Usu\xe1rio: ... Agente: ..."})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("label",{className:"flex items-center space-x-2 text-sm text-white/80",children:[(0,r.jsx)("input",{type:"checkbox",checked:t.reforcarCoT,onChange:e=>n("reforcarCoT",e.target.checked),className:"form-checkbox h-4 w-4 text-emerald-500 bg-white/5 border-white/10 rounded focus:ring-emerald-500"}),(0,r.jsx)("span",{children:"Refor\xe7ar CoT"})]}),(0,r.jsxs)("label",{className:"flex items-center space-x-2 text-sm text-white/80",children:[(0,r.jsx)("input",{type:"checkbox",checked:t.ativarGuardrails,onChange:e=>n("ativarGuardrails",e.target.checked),className:"form-checkbox h-4 w-4 text-emerald-500 bg-white/5 border-white/10 rounded focus:ring-emerald-500"}),(0,r.jsx)("span",{children:"Guardrails"})]})]})]})]})},m=e=>{let{variavel:t,onUpdate:a,onRemove:s}=e,o="w-full p-2 bg-white/5 border border-white/10 rounded-md text-white/80 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 text-sm";return(0,r.jsxs)("div",{className:"bg-white/5 p-3 rounded-lg border border-white/10 space-y-2 relative",children:[(0,r.jsx)("button",{onClick:()=>s(t.id),className:"absolute top-2 right-2 text-white/40 hover:text-red-400 transition-colors",title:"Remover Vari\xe1vel",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-white/60 mb-1",children:"Chave"}),(0,r.jsx)("input",{type:"text",value:t.chave,onChange:e=>a(t.id,"chave",e.target.value),className:o,placeholder:"ex: NOME_CLIENTE"})]}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-white/60 mb-1",children:"Valor"}),(0,r.jsx)("input",{type:"text",value:t.valor,onChange:e=>a(t.id,"valor",e.target.value),className:o,placeholder:"ex: Jo\xe3o"})]})]})]})},x=e=>{let{ferramenta:t,onUpdate:a,onRemove:s}=e,o="w-full p-2 bg-white/5 border border-white/10 rounded-md text-white/80 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 text-sm";return(0,r.jsxs)("div",{className:"bg-white/5 p-3 rounded-lg border border-white/10 space-y-2 relative",children:[(0,r.jsx)("button",{onClick:()=>s(t.id),className:"absolute top-2 right-2 text-white/40 hover:text-red-400 transition-colors",title:"Remover Ferramenta",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-white/60 mb-1",children:"Nome da Ferramenta"}),(0,r.jsx)("input",{type:"text",value:t.nome,onChange:e=>a(t.id,"nome",e.target.value),className:o,placeholder:"ex: buscar_pedido"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-white/60 mb-1",children:"Descri\xe7\xe3o"}),(0,r.jsx)("textarea",{value:t.descricao,onChange:e=>a(t.id,"descricao",e.target.value),rows:2,className:o,placeholder:"ex: Busca os detalhes de um pedido pelo n\xfamero de identifica\xe7\xe3o."})]})]})};var h=a(6517),u=a(8231),p=a(4246);let v=e=>{let{onDataExtracted:t,isLoading:a,onLoadingChange:o}=e,[l,i]=(0,s.useState)(!1),[n,c]=(0,s.useState)([]),[d,m]=(0,s.useState)(new Map),[x,v]=(0,s.useState)(null),[w,b]=(0,s.useState)({current:0,total:0}),g=(0,s.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?i(!0):"dragleave"===e.type&&i(!1)},[]),f=e=>new Promise((t,a)=>{let r=new FileReader;r.onloadend=()=>{var e;let s=null==(e=r.result)?void 0:e.toString().split(",")[1];s?t(s):a(Error("Falha ao ler arquivo."))},r.onerror=()=>a(Error("Erro ao ler arquivo.")),r.readAsDataURL(e)}),j=async e=>new Promise((t,a)=>{let r=new FileReader;r.onload=e=>{try{var r;let a=new Uint8Array(null==(r=e.target)?void 0:r.result),s=p.LF(a,{type:"array"}),o=s.SheetNames[0],l=s.Sheets[o],i=p.Wp.sheet_to_csv(l);t(i)}catch(e){a(Error("Erro ao converter Excel para CSV: ".concat(e instanceof Error?e.message:"Erro desconhecido")))}},r.onerror=()=>a(Error("Erro ao ler arquivo Excel.")),r.readAsArrayBuffer(e)}),N=e=>{let t=e.name.toLowerCase().endsWith(".md"),a=e.name.toLowerCase().endsWith(".csv"),r=e.name.toLowerCase().endsWith(".xlsx")||e.name.toLowerCase().endsWith(".xls");return t&&(!e.type||""===e.type)?"text/markdown":a&&(!e.type||"application/vnd.ms-excel"===e.type)||r?"text/csv":e.type||"text/plain"},k=(0,s.useCallback)(async e=>{v(null),o(!0);let{valid:a,errors:r}=(e=>{let t=[],a=[];return e.forEach(e=>{let r=(0,u.zf)(e);if(!r.valid)return void a.push("".concat(e.name,": ").concat(r.error||"Tipo de arquivo n\xe3o permitido."));let s=(0,u.Gg)(e);if(!s.valid)return void a.push("".concat(e.name,": ").concat(s.error||"Arquivo muito grande."));if(e.name.length>255)return void a.push("".concat(e.name,": Nome muito longo (m\xe1ximo 255 caracteres)."));let o=e.name.toLowerCase().endsWith(".md"),l=e.name.toLowerCase().endsWith(".csv"),i=e.name.toLowerCase().endsWith(".xlsx")||e.name.toLowerCase().endsWith(".xls");if(!["application/pdf","text/plain","text/markdown","text/x-markdown","text/html","text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(e.type)&&!o&&!l&&!i)return void a.push("".concat(e.name,": Formato n\xe3o suportado. Use PDF, TXT, MD, HTML, CSV, XLSX ou XLS."));t.push(e)}),{valid:t,errors:a}})(e);if(r.length>0&&(v("Erros de valida\xe7\xe3o:\n".concat(r.join("\n"))),o(!1),0===a.length))return;if(0===a.length)return void o(!1);c(a);let s=new Map;a.forEach(e=>{s.set(e.name,{name:e.name,status:"pending"})}),m(s),b({current:0,total:a.length});let l=[];for(let e=0;e<a.length;e++){let t=a[e];await new Promise(e=>setTimeout(e,50)),s.set(t.name,{name:t.name,status:"processing"}),m(new Map(s)),b({current:e,total:a.length}),await new Promise(e=>setTimeout(e,10));try{let r,o,i=t.name.toLowerCase().endsWith(".xlsx")||t.name.toLowerCase().endsWith(".xls"),n=t.name;if(i){let e=await j(t),a=new Blob([e],{type:"text/csv;charset=utf-8;"});r=await new Promise((e,t)=>{let r=new FileReader;r.onloadend=()=>{var a;let s=null==(a=r.result)?void 0:a.toString().split(",")[1];s?e(s):t(Error("Falha ao converter CSV para base64."))},r.onerror=()=>t(Error("Erro ao ler CSV convertido.")),r.readAsDataURL(a)}),o="text/csv",n=t.name.replace(/\.(xlsx|xls)$/i,".csv")}else r=await f(t),o=N(t);let c=await (0,h.IG)(r,o,n);l.push(c),s.set(t.name,{name:t.name,status:"completed"}),m(new Map(s)),b({current:e+1,total:a.length})}catch(o){console.error("Erro ao analisar ".concat(t.name,":"),o);let r=o.message||"Falha na an\xe1lise do documento.";s.set(t.name,{name:t.name,status:"error",error:r}),m(new Map(s)),b({current:e+1,total:a.length})}}l.length>0&&t(y(l)),b({current:a.length,total:a.length}),o(!1)},[o,t]),y=e=>{let t={persona:"",objetivo:"",contextoNegocio:"",contexto:"",regras:[]},a=e.map(e=>e.persona).filter(Boolean);a.length>0&&(t.persona=a.join("\n\n---\n\n"));let r=e.map(e=>e.objetivo).filter(Boolean);r.length>0&&(t.objetivo=r.join("\n\n---\n\n"));let s=e.map(e=>e.contextoNegocio).filter(Boolean);s.length>0&&(t.contextoNegocio=s.join("\n\n---\n\n"));let o=e.map(e=>e.contexto).filter(Boolean);o.length>0&&(t.contexto=o.join("\n\n---\n\n"));let l=e.flatMap(e=>e.regras||[]).filter((e,t,a)=>a.indexOf(e)===t);return l.length>0&&(t.regras=l),t};(0,s.useCallback)(async e=>{await k([e])},[k]);let C=(0,s.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),i(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0&&k(Array.from(e.dataTransfer.files))},[k]);return(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white/80 mb-2",children:"Importar Conhecimento (Upload)"}),(0,r.jsxs)("div",{className:"relative border-2 border-dashed rounded-lg p-6 text-center transition-colors ".concat(l?"border-emerald-500 bg-emerald-500/10":"border-white/10 hover:border-white/20 bg-white/5"," ").concat(a?"opacity-50 cursor-wait":"cursor-pointer"),onDragEnter:g,onDragLeave:g,onDragOver:g,onDrop:C,children:[(0,r.jsx)("input",{type:"file",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10 disabled:cursor-not-allowed",onChange:e=>{e.preventDefault(),e.target.files&&e.target.files.length>0&&(k(Array.from(e.target.files)),e.target.value="")},accept:".pdf,.txt,.md,.html,.csv,.xlsx,.xls",disabled:a,multiple:!0}),(0,r.jsx)("div",{className:"flex flex-col items-center justify-center space-y-2",children:a?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin h-8 w-8 text-emerald-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),w.total>0&&(0,r.jsxs)("p",{className:"text-sm text-white/80 font-medium",children:["Processando ",w.current+1," de ",w.total," arquivo(s)..."]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"w-10 h-10 text-white/40",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,r.jsx)("p",{className:"text-sm text-white/80 font-medium",children:"Arraste ou clique para upload"}),(0,r.jsx)("p",{className:"text-xs text-white/40",children:"Suporta m\xfaltiplos arquivos: PDF, TXT, MD, HTML, CSV, XLSX, XLS"})]})})]}),d.size>0&&(0,r.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,r.jsxs)("p",{className:"text-sm text-white/80 font-medium",children:["Arquivos (",Array.from(d.values()).filter(e=>"completed"===e.status).length,"/",d.size," conclu\xeddos)"]}),(0,r.jsx)("div",{className:"space-y-1 max-h-48 overflow-y-auto",children:Array.from(d.values()).map(e=>(0,r.jsxs)("div",{className:"p-2 rounded-lg border text-xs ".concat("completed"===e.status?"bg-emerald-900/20 border-emerald-700/50 text-emerald-300":"processing"===e.status?"bg-yellow-900/20 border-yellow-700/50 text-yellow-300":"error"===e.status?"bg-red-900/20 border-red-700/50 text-red-300":"bg-white/5 border-white/10 text-white/60"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"truncate flex-1",children:e.name}),"completed"===e.status&&(0,r.jsx)("svg",{className:"w-4 h-4 ml-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"processing"===e.status&&(0,r.jsxs)("svg",{className:"animate-spin w-4 h-4 ml-2 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"error"===e.status&&(0,r.jsx)("svg",{className:"w-4 h-4 ml-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]}),e.error&&(0,r.jsx)("p",{className:"mt-1 text-red-400 text-xs",children:e.error})]},e.name))})]}),x&&(0,r.jsxs)("div",{className:"mt-2 p-3 bg-red-900/30 border border-red-700/50 rounded-lg",children:[(0,r.jsx)("p",{className:"text-sm text-red-300 font-medium",children:"⚠️ Erro ao processar documento(s)"}),(0,r.jsx)("p",{className:"text-xs text-red-400 mt-1 whitespace-pre-line",children:x})]})]})},w=["text","markdown","json","xml","yaml"],b=["markdown","json"],g=e=>{let{formData:t,setFormData:a,onGenerate:o,isLoading:l,onGenerateExamples:i,isGeneratingExamples:h,activePromptContent:u,onSaveToRepository:p,isSavingToRepository:g=!1}=e,[f,j]=(0,s.useState)(!1),N=(e,t)=>{a(a=>({...a,[e]:t}))},k=(e,a,r)=>{N("exemplos",t.exemplos.map(t=>t.id===e?{...t,[a]:r}:t))},y=e=>N("exemplos",t.exemplos.filter(t=>t.id!==e)),C=(e,a,r)=>{N("variaveisDinamicas",t.variaveisDinamicas.map(t=>t.id===e?{...t,[a]:r}:t))},L=e=>N("variaveisDinamicas",t.variaveisDinamicas.filter(t=>t.id!==e)),E=(e,a,r)=>{N("ferramentas",t.ferramentas.map(t=>t.id===e?{...t,[a]:r}:t))},S=e=>N("ferramentas",t.ferramentas.filter(t=>t.id!==e)),z=(e,a)=>{N("fluxos",t.fluxos.map(t=>t.id===e?{...t,...a}:t))},M=e=>N("fluxos",t.fluxos.filter(t=>t.id!==e)),R="w-full p-2 bg-white/5 border border-white/10 rounded-md text-white/80 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500";return(0,r.jsxs)("div",{className:"p-3 sm:p-4 md:p-5 lg:p-6 space-y-3 sm:space-y-4 md:space-y-5 overflow-y-auto h-full",children:[(0,r.jsx)(v,{onDataExtracted:e=>{a(t=>({...t,persona:e.persona||t.persona,objetivo:e.objetivo||t.objetivo,contextoNegocio:e.contextoNegocio||t.contextoNegocio,contexto:e.contexto||t.contexto,regras:e.regras?[...t.regras,...e.regras.filter(e=>e)]:t.regras}))},isLoading:f,onLoadingChange:j}),(0,r.jsx)(n,{title:"1. Persona e Objetivo",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-white/80 mb-1",children:"Persona"}),(0,r.jsx)("textarea",{value:t.persona,onChange:e=>N("persona",e.target.value),rows:3,className:R})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-white/80 mb-1",children:"Objetivo Principal"}),(0,r.jsx)("textarea",{value:t.objetivo,onChange:e=>N("objetivo",e.target.value),rows:3,className:R})]})]})}),(0,r.jsx)(n,{title:"2. Contexto do Neg\xf3cio",children:(0,r.jsx)("textarea",{value:t.contextoNegocio,onChange:e=>N("contextoNegocio",e.target.value),rows:4,className:R})}),(0,r.jsx)(n,{title:"3. Contexto da Intera\xe7\xe3o",children:(0,r.jsx)("textarea",{value:t.contexto,onChange:e=>N("contexto",e.target.value),rows:4,className:R})}),(0,r.jsx)(n,{title:"4. Regras Inviol\xe1veis",children:(0,r.jsxs)("div",{className:"space-y-2",children:[t.regras.map((e,a)=>(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"text",value:e,onChange:e=>((e,a)=>{let r=[...t.regras];r[e]=a,N("regras",r)})(a,e.target.value),className:R}),(0,r.jsx)("button",{onClick:()=>N("regras",t.regras.filter((e,t)=>t!==a)),className:"p-2 text-red-400 hover:text-red-300",children:"\xd7"})]},a)),(0,r.jsx)("button",{onClick:()=>N("regras",[...t.regras,""]),className:"text-emerald-400 hover:text-emerald-300",children:"+ Adicionar Regra"})]})}),(0,r.jsx)(n,{title:"5. Exemplos (Few-Shot)",children:(0,r.jsxs)("div",{className:"space-y-3",children:[t.exemplos.map(e=>(0,r.jsx)(c,{example:e,onUpdate:k,onRemove:y},e.id)),(0,r.jsxs)("div",{className:"flex items-center space-x-4 pt-2",children:[(0,r.jsx)("button",{onClick:()=>N("exemplos",[...t.exemplos,{id:crypto.randomUUID(),user:"",agent:""}]),className:"text-emerald-400 hover:text-emerald-300 font-medium",children:"+ Adicionar Exemplo"}),(0,r.jsxs)("button",{onClick:i,disabled:h||l||f,className:"flex items-center space-x-2 text-emerald-400 hover:text-emerald-300 font-medium disabled:text-white/40 disabled:cursor-wait",children:[h?(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,r.jsx)("svg",{className:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{d:"M9.43 2.58a1 1 0 00-1.412-.238l-4.148 2.963a1 1 0 00-.422.82v8.15a1 1 0 00.422.82l4.148 2.963a1 1 0 001.412-.238l4.148-2.963a1 1 0 00.422-.82v-2.438l2.148-1.534a1 1 0 00.422-.82v-1.5a1 1 0 00-.422-.82L14 6.838V4.399a1 1 0 00-.422-.82L9.43 2.58zM12 11.3v2.4l-2 1.428v-2.4L12 11.3zM10 9.9v2.4L8 10.872V8.47L10 9.9zM8 7.128L10 8.5v-2.4L8 4.672v2.456zM12 6.1v2.4L14 7.072V4.672L12 6.1z"})}),(0,r.jsx)("span",{children:"Gerar com IA"})]})]})]})}),(0,r.jsx)(n,{title:"6. Vari\xe1veis Din\xe2micas",children:(0,r.jsxs)("div",{className:"space-y-3",children:[t.variaveisDinamicas.map(e=>(0,r.jsx)(m,{variavel:e,onUpdate:C,onRemove:L},e.id)),(0,r.jsx)("button",{onClick:()=>N("variaveisDinamicas",[...t.variaveisDinamicas,{id:crypto.randomUUID(),chave:"",valor:""}]),className:"text-emerald-400 hover:text-emerald-300",children:"+ Adicionar Vari\xe1vel"})]})}),(0,r.jsx)(n,{title:"7. Ferramentas (Tools)",children:(0,r.jsxs)("div",{className:"space-y-3",children:[t.ferramentas.map(e=>(0,r.jsx)(x,{ferramenta:e,onUpdate:E,onRemove:S},e.id)),(0,r.jsx)("button",{onClick:()=>N("ferramentas",[...t.ferramentas,{id:crypto.randomUUID(),nome:"",descricao:""}]),className:"text-emerald-400 hover:text-emerald-300",children:"+ Adicionar Ferramenta"})]})}),(0,r.jsx)(n,{title:"8. Fluxos de Intera\xe7\xe3o",children:(0,r.jsxs)("div",{className:"space-y-3",children:[t.fluxos.map(e=>(0,r.jsx)(d,{fluxo:e,onUpdate:z,onRemove:M},e.id)),(0,r.jsx)("button",{onClick:()=>{let e={id:crypto.randomUUID(),nome:"Novo Fluxo ".concat(t.fluxos.length+1),tipoPrompt:"Resposta a Pergunta",objetivo:"",baseConhecimentoRAG:"",fewShotExamples:"",reforcarCoT:!1,ativarGuardrails:!1};N("fluxos",[...t.fluxos,e])},className:"text-emerald-400 hover:text-emerald-300",children:"+ Adicionar Fluxo"})]})}),(0,r.jsx)(n,{title:"9. Formatos (Prompt e Agente)",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"p-3 bg-white/5 border border-emerald-500/30 rounded-md",children:[(0,r.jsx)("label",{className:"block text-sm font-bold text-emerald-300 mb-1",children:"Formato do PROMPT MESTRE (Artefato Gerado)"}),(0,r.jsx)("p",{className:"text-xs text-white/40 mb-2",children:"Escolha como voc\xea quer que o prompt final seja estruturado."}),(0,r.jsx)("select",{value:t.masterPromptFormat,onChange:e=>N("masterPromptFormat",e.target.value),className:R,children:b.map(e=>(0,r.jsx)("option",{value:e,children:e.toUpperCase()},e))})]}),(0,r.jsxs)("div",{className:"p-3 bg-white/5 border border-emerald-500/30 rounded-md",children:[(0,r.jsx)("label",{className:"block text-sm font-bold text-emerald-300 mb-1",children:"Formato de Resposta do AGENTE (Final)"}),(0,r.jsx)("p",{className:"text-xs text-white/40 mb-2",children:"Escolha como o agente deve responder ao usu\xe1rio final."}),(0,r.jsx)("select",{value:t.formatoSaida,onChange:e=>N("formatoSaida",e.target.value),className:R,children:w.map(e=>(0,r.jsx)("option",{value:e,children:"text"===e?"TEXTO PURO (Chatbot/Natural)":e.toUpperCase()},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-white/80 mb-1",children:"Estrutura de Resposta Esperada (Opcional)"}),(0,r.jsx)("textarea",{value:t.estruturaSaida,onChange:e=>N("estruturaSaida",e.target.value),rows:3,className:R,placeholder:"Ex: Comece com uma sauda\xe7\xe3o, responda a pergunta e termine oferecendo mais ajuda."})]})]})}),(0,r.jsx)(n,{title:"10. Tamanho e Complexidade",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-white/80 mb-2",children:["Tamanho Alvo do Prompt: ",(0,r.jsx)("span",{className:"font-bold text-emerald-400",children:t.promptSize.toLocaleString("pt-BR")})," caracteres"]}),(0,r.jsx)("input",{type:"range",min:"5000",max:"50000",step:"1000",value:t.promptSize,onChange:e=>N("promptSize",parseInt(e.target.value,10)),className:"w-full h-2 bg-white/10 rounded-lg appearance-none cursor-pointer accent-emerald-500",disabled:f}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-white/40 mt-1",children:[(0,r.jsx)("span",{children:"Simples"}),(0,r.jsx)("span",{children:"Complexo"})]})]})}),(0,r.jsxs)("div",{className:"pt-4 sticky bottom-0 bg-black/50 -mx-4 px-4 pb-4 space-y-2",children:[(0,r.jsx)("button",{onClick:o,disabled:l||f,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3 px-4 rounded-lg transition disabled:bg-white/20 disabled:cursor-not-allowed flex items-center justify-center text-lg",children:l?"Gerando...":"Gerar Prompt Mestre"}),p&&(0,r.jsx)("button",{onClick:p,disabled:g||f||!t.persona.trim(),className:"w-full bg-white/10 hover:bg-white/20 text-white font-semibold py-2.5 px-4 rounded-lg transition disabled:bg-white/5 disabled:text-white/40 disabled:cursor-not-allowed flex items-center justify-center space-x-2",title:"Salvar o prompt atual no reposit\xf3rio (ele j\xe1 \xe9 salvo automaticamente, mas este bot\xe3o for\xe7a o salvamento)",children:g?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,r.jsx)("span",{children:"Salvando..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),(0,r.jsx)("span",{children:"Salvar no Reposit\xf3rio"})]})})]})]})};var f=a(5024);let j=e=>{let{version:t,isLoading:a,error:o,isValidated:l,onValidate:i,onExplain:n}=e,[c,d]=(0,s.useState)(""),[m,x]=(0,s.useState)(""),[h,u]=(0,s.useState)(!1),[p,v]=(0,s.useState)(!1),[w,b]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{try{let e=await (0,f.gg)();v(e.allowed);let t=await (0,f.Ty)();b(t)}catch(e){console.error("Erro ao verificar permiss\xf5es:",e),v(!1)}})()},[]),s.useEffect(()=>{},[t]);let g=(null==t?void 0:t.content)||"",j=g.length,N=Math.round(j/4),k=async()=>{if(!t)return;let e=await (0,f.gg)();if(!e.allowed)return void alert(e.reason||"Compartilhamento n\xe3o dispon\xedvel no seu plano");let a=window.location.origin;x("".concat(a,"/chat/").concat(t.id)),u(!0)};return(0,r.jsx)("div",{className:"bg-white/5 rounded-lg h-full flex flex-col relative",children:a?(0,r.jsxs)("div",{className:"absolute inset-0 bg-black/75 flex flex-col items-center justify-center z-10",children:[(0,r.jsxs)("svg",{className:"animate-spin h-10 w-10 text-emerald-400 mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,r.jsx)("p",{className:"text-lg text-white/80",children:"Gerando prompt..."})]}):o?(0,r.jsxs)("div",{className:"m-4 text-red-400 p-4 bg-red-900 bg-opacity-50 rounded-md",children:[(0,r.jsx)("h3",{className:"font-bold",children:"Erro na Opera\xe7\xe3o"}),(0,r.jsx)("p",{children:o})]}):t&&t.content&&0!==t.content.trim().length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center border-b border-white/10 p-3 flex-shrink-0",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-lg font-bold text-emerald-400",children:["Vers\xe3o ",t.version,(0,r.jsxs)("span",{className:"text-xs font-normal text-white/60 ml-2 px-2 py-0.5 bg-white/10 rounded-full",children:["Alvo: ",t.format.toUpperCase()]})]}),(0,r.jsx)("p",{className:"text-xs text-white/40",children:t.timestamp})]}),l?(0,r.jsxs)("div",{className:"flex items-center space-x-2 bg-green-500/10 text-green-400 text-sm font-semibold px-3 py-1 rounded-full",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a.75.75 0 00-1.06-1.06L9 10.94l-1.72-1.72a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.06 0l3.75-3.75z",clipRule:"evenodd"})}),(0,r.jsx)("span",{children:"Prompt Validado"})]}):(0,r.jsx)("button",{onClick:()=>i(t.id),className:"bg-green-600/80 hover:bg-green-600 text-white font-bold py-1 px-3 rounded-lg transition text-sm",children:"Validar Prompt"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-white/80",children:[j.toLocaleString("pt-BR")," ",(0,r.jsx)("span",{className:"text-xs text-white/40",children:"chars"})]}),(0,r.jsxs)("p",{className:"text-sm font-medium text-white/80",children:["~",N.toLocaleString("pt-BR")," ",(0,r.jsx)("span",{className:"text-xs text-white/40",children:"tokens"})]})]}),(0,r.jsx)("button",{onClick:()=>n(g),disabled:!g,className:"bg-white/10 hover:bg-white/20 text-white font-bold py-2 px-3 rounded-lg transition text-sm",children:"Explicar"}),(0,r.jsx)("button",{onClick:()=>{g&&navigator.clipboard.writeText(g).then(()=>{d("Copiado!"),setTimeout(()=>d(""),2e3)},()=>{d("Falha."),setTimeout(()=>d(""),2e3)})},className:"bg-white/10 hover:bg-white/20 text-white font-bold py-2 px-3 rounded-lg transition text-sm",children:c||"Copiar"}),(0,r.jsx)("button",{onClick:()=>{if(!t||!g)return;let e=new Blob([g],{type:"text/plain;charset=utf-8"}),a=URL.createObjectURL(e),r=document.createElement("a");r.href=a,r.download="prompt_v".concat(t.version,".md"),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a)},className:"bg-white/10 hover:bg-white/20 text-white font-bold py-2 px-3 rounded-lg transition text-sm",children:"Baixar"}),(0,r.jsxs)("button",{onClick:p?k:()=>alert("Compartilhar chat n\xe3o est\xe1 dispon\xedvel no plano Trial. Upgrade para Premium para acessar este recurso."),disabled:!t||!p,className:"".concat(p?"bg-emerald-600 hover:bg-emerald-700":"bg-white/10 text-white/40 cursor-not-allowed"," text-white font-bold py-2 px-3 rounded-lg transition text-sm disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-1"),title:p?"Compartilhar chat":"Compartilhar chat n\xe3o dispon\xedvel no Trial. Upgrade para Premium.",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),(0,r.jsx)("span",{children:"Compartilhar"})]})]})]}),h&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 backdrop-blur-sm",onClick:()=>u(!1),children:(0,r.jsxs)("div",{className:"bg-black/90 backdrop-blur-sm p-6 rounded-xl shadow-2xl w-full max-w-md border border-white/10 animate-in fade-in zoom-in duration-200",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-white",children:"Compartilhar Chat"}),(0,r.jsx)("button",{onClick:()=>u(!1),className:"text-white/60 hover:text-white transition",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsx)("p",{className:"text-white/60 text-sm mb-4",children:"Compartilhe este link para que clientes testem o chat com esta vers\xe3o do prompt:"}),(0,r.jsxs)("div",{className:"flex space-x-2 mb-4",children:[(0,r.jsx)("input",{type:"text",value:m,readOnly:!0,className:"flex-1 px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white/80 text-sm"}),(0,r.jsx)("button",{onClick:()=>{m&&navigator.clipboard.writeText(m).then(()=>{d("Link copiado!"),setTimeout(()=>{d(""),u(!1)},2e3)})},className:"bg-emerald-600 hover:bg-emerald-700 text-white font-bold px-4 py-2 rounded-lg transition text-sm",children:c?"Copiado!":"Copiar"})]}),(0,r.jsx)("div",{className:"bg-emerald-900/20 border border-emerald-700/50 rounded-lg p-3",children:(0,r.jsxs)("p",{className:"text-emerald-300 text-xs",children:["\uD83D\uDCA1 ",(0,r.jsx)("strong",{children:"Dica:"})," O link abrir\xe1 uma nova aba com o chat conversacional. O cliente poder\xe1 interagir com o agente usando esta vers\xe3o do prompt."]})})]})}),(0,r.jsx)("div",{className:"flex-grow p-4 overflow-auto font-mono",children:(0,r.jsx)("pre",{className:"text-sm text-white/80 whitespace-pre-wrap break-all",children:(0,r.jsx)("code",{children:g})})})]}):(0,r.jsx)("div",{className:"flex items-center justify-center h-full text-white/40",children:"Aguardando a gera\xe7\xe3o do prompt..."})})},N=e=>{let{history:t,activeVersionId:a,onSelectVersion:s,onDeleteVersion:o,validatedVersionId:l,onImport:i,onPaste:n,onShare:c}=e;return(0,r.jsxs)("div",{className:"p-4 h-full flex flex-col",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4 border-b border-white/10 pb-2",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white/80",children:"Hist\xf3rico de Vers\xf5es"}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{onClick:n,className:"flex items-center space-x-1 bg-white/10 hover:bg-white/20 text-white/80 py-1 px-2 rounded-lg transition text-xs",title:"Colar um prompt da \xe1rea de transfer\xeancia",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),(0,r.jsx)("span",{children:"Colar"})]}),(0,r.jsxs)("button",{onClick:i,className:"flex items-center space-x-1 bg-white/10 hover:bg-white/20 text-white/80 py-1 px-2 rounded-lg transition text-xs",title:"Importar um prompt de um arquivo .txt ou .md",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),(0,r.jsx)("span",{children:"Importar"})]})]})]}),t&&0!==t.length?(0,r.jsx)("div",{className:"flex-grow overflow-y-auto pr-2 -mr-2",children:(0,r.jsx)("ul",{className:"space-y-2",children:(t||[]).slice().reverse().map(e=>(0,r.jsx)("li",{onClick:()=>s(e.id),className:"p-3 rounded-lg cursor-pointer transition-colors group border-l-4 ".concat(a===e.id?"bg-white/10 border-emerald-400":"bg-white/5 border-transparent hover:bg-white/10"),children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 overflow-hidden",children:[l===e.id&&(0,r.jsx)("svg",{className:"w-5 h-5 text-green-400 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a.75.75 0 00-1.06-1.06L9 10.94l-1.72-1.72a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.06 0l3.75-3.75z",clipRule:"evenodd"})}),(0,r.jsxs)("div",{className:"truncate",children:[(0,r.jsxs)("p",{className:"font-bold truncate ".concat(a===e.id?"text-emerald-400":"text-white/80"),children:["v",e.version," ",(0,r.jsxs)("span",{className:"font-normal opacity-70",children:["- ",e.sourceData.persona.slice(0,20),e.sourceData.persona.length>20?"...":""]})]}),(0,r.jsx)("p",{className:"text-xs text-white/40",children:e.timestamp})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[c&&(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),c(e.id)},className:"text-white/40 hover:text-emerald-400 flex-shrink-0",title:"Compartilhar vers\xe3o",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})}),(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),o(e.id)},className:"text-white/40 hover:text-red-400 flex-shrink-0",title:"Deletar vers\xe3o",children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},e.id))})}):(0,r.jsx)("div",{className:"flex-grow flex items-center justify-center text-white/40 text-center text-sm p-4",children:"Nenhuma vers\xe3o gerada. Gere um novo prompt ou importe um existente."})]})},k=e=>{let{messages:t,onSendMessage:a,onClearChat:o,isLoading:l,disabled:i,onUpdateMessage:n,onSaveCorrection:c,onDownloadChat:d}=e;s.useEffect(()=>{},[t,i,l]);let[m,x]=(0,s.useState)(""),[h,u]=(0,s.useState)(""),[p,v]=(0,s.useState)(!1),w=(0,s.useRef)(null),b=(0,s.useRef)(null);(0,s.useEffect)(()=>{var e;null==(e=w.current)||e.scrollIntoView({behavior:"smooth"})},[t]),(0,s.useEffect)(()=>{let e=e=>{b.current&&!b.current.contains(e.target)&&v(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[b]);let g=()=>{!m.trim()||l||i||(a(m.trim()),x(""))},f=(e,a)=>{let r=t[e];if(r.feedback===a)return void n(e,{feedback:void 0,isEditing:!1});"incorrect"===a?(n(e,{feedback:"incorrect",isEditing:!0}),u(r.text)):n(e,{feedback:"correct",isEditing:!1})},j=e=>{d(e),v(!1)};return i?(0,r.jsxs)("div",{className:"p-4 h-full flex flex-col space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white/80",children:"Teste do Prompt"}),(0,r.jsx)("p",{className:"text-sm text-white/60 mt-1",children:"Gere ou selecione uma vers\xe3o de prompt para ativar o chat."})]}),(0,r.jsx)("div",{className:"flex-grow flex items-center justify-center text-white/40 bg-white/5 rounded-lg",children:(0,r.jsx)("p",{children:"Chat desativado."})})]}):(0,r.jsxs)("div",{className:"p-4 h-full flex flex-col space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white/80",children:"Teste do Prompt"}),(0,r.jsx)("p",{className:"text-sm text-white/60 mt-1",children:"Interaja com o prompt da vers\xe3o ativa para validar o comportamento."})]}),t.length>0&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("div",{className:"relative",ref:b,children:[(0,r.jsxs)("button",{onClick:()=>v(e=>!e),disabled:l,className:"text-xs flex items-center space-x-1 text-white/60 hover:text-emerald-400 transition-colors px-2 py-1 rounded-md hover:bg-white/10",title:"Baixar hist\xf3rico da conversa",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),(0,r.jsx)("span",{children:"Baixar"}),(0,r.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),p&&(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-32 bg-white/10 border border-white/20 rounded-md shadow-lg z-10 backdrop-blur-sm",children:[(0,r.jsx)("button",{onClick:()=>j("txt"),className:"block w-full text-left px-4 py-2 text-sm text-white/80 hover:bg-white/20",children:"Baixar TXT"}),(0,r.jsx)("button",{onClick:()=>j("pdf"),className:"block w-full text-left px-4 py-2 text-sm text-white/80 hover:bg-white/20",children:"Baixar PDF"})]})]}),(0,r.jsxs)("button",{onClick:o,disabled:l,className:"text-xs flex items-center space-x-1 text-white/60 hover:text-red-400 transition-colors px-2 py-1 rounded-md hover:bg-white/10",title:"Limpar hist\xf3rico e reiniciar conversa",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),(0,r.jsx)("span",{children:"Limpar"})]})]})]}),(0,r.jsxs)("div",{className:"flex-grow bg-white/5 rounded-lg p-2 flex flex-col space-y-2 overflow-y-auto",children:[0===t.length?(0,r.jsx)("div",{className:"flex-grow flex items-center justify-center text-white/40 text-sm italic",children:"Envie uma mensagem para iniciar o teste."}):t.map((e,t)=>(0,r.jsxs)("div",{className:"flex flex-col ".concat("user"===e.author?"items-end":"items-start"),children:[(0,r.jsx)("div",{className:"rounded-lg px-3 py-2 max-w-xs lg:max-w-md ".concat("user"===e.author?"bg-emerald-600 text-white":"bg-white/10 text-white/80"),children:(0,r.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.text})}),"agent"===e.author&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"mt-1.5 flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>f(t,"correct"),title:"Resposta correta",className:"p-1 rounded-full transition-colors ".concat("correct"===e.feedback?"bg-green-500/30 text-green-400":"text-white/40 hover:text-green-400 hover:bg-white/10"),children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{d:"M11 3a1 1 0 10-2 0v1a1 1 0 102 0V3zM15.657 5.757a1 1 0 00-1.414-1.414l-.707.707a1 1 0 001.414 1.414l.707-.707zM18 10a1 1 0 01-1 1h-1a1 1 0 110-2h1a1 1 0 011 1zM5.05 14.95a1 1 0 001.414 1.414l.707-.707a1 1 0 00-1.414-1.414l-.707.707zM10 18a1 1 0 01-1-1v-1a1 1 0 112 0v1a1 1 0 01-1 1zM4.343 5.757a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414l.707.707zM2 10a1 1 0 01-1-1h-1a1 1 0 110-2h1a1 1 0 011 1zM14.95 14.95a1 1 0 00-1.414 1.414l.707.707a1 1 0 001.414-1.414l-.707-.707z"})})}),(0,r.jsx)("button",{onClick:()=>f(t,"incorrect"),title:"Resposta incorreta",className:"p-1 rounded-full transition-colors ".concat("incorrect"===e.feedback?"bg-red-500/30 text-red-400":"text-white/40 hover:text-red-400 hover:bg-white/10"),children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})})]}),e.isEditing&&(0,r.jsxs)("div",{className:"mt-2 w-full max-w-xs lg:max-w-md",children:[(0,r.jsx)("p",{className:"text-xs text-white/60 mb-1",children:"Corrija a resposta do agente:"}),(0,r.jsx)("textarea",{value:h,onChange:e=>u(e.target.value),rows:4,className:"w-full p-2 text-sm bg-white/5 border border-white/10 rounded-md text-white/80 focus:ring-2 focus:ring-emerald-500"}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2 mt-2",children:[(0,r.jsx)("button",{onClick:()=>n(t,{isEditing:!1}),className:"text-xs bg-white/10 hover:bg-white/20 text-white font-semibold py-1 px-3 rounded-md transition",children:"Cancelar"}),(0,r.jsx)("button",{onClick:()=>{h.trim()&&(c(t,h.trim()),u(""))},className:"text-xs bg-emerald-600 hover:bg-emerald-700 text-white font-semibold py-1 px-3 rounded-md transition",children:"Salvar Corre\xe7\xe3o"})]})]}),e.correction&&!e.isEditing&&(0,r.jsxs)("div",{className:"mt-2 w-full max-w-xs lg:max-w-md bg-emerald-900/50 border-l-2 border-emerald-500 p-2 rounded-r-md",children:[(0,r.jsx)("p",{className:"text-xs font-bold text-emerald-300",children:"Sua corre\xe7\xe3o:"}),(0,r.jsx)("p",{className:"text-sm text-white/80 whitespace-pre-wrap",children:e.correction})]})]})]},t)),l&&(0,r.jsx)("div",{className:"flex justify-start",children:(0,r.jsx)("div",{className:"rounded-lg px-3 py-2 bg-white/10 text-white/80",children:(0,r.jsx)("span",{className:"animate-pulse",children:"..."})})}),(0,r.jsx)("div",{ref:w})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("input",{type:"text",value:m,onChange:e=>x(e.target.value),onKeyPress:e=>{"Enter"===e.key&&g()},className:"flex-grow p-2 bg-white/5 border border-white/10 rounded-md text-white/80 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500",placeholder:"Digite sua mensagem...",disabled:l}),(0,r.jsx)("button",{onClick:g,disabled:l||!m.trim(),className:"bg-emerald-600 hover:bg-emerald-700 text-white font-bold p-2 rounded-md transition disabled:bg-white/20 disabled:cursor-not-allowed flex items-center justify-center px-4",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})]})},y=e=>{let{onOptimize:t,isLoading:a,disabled:o,optimizationPairs:l,onClearCorrections:i,manualInstructions:n,onManualInstructionsChange:c}=e;s.useEffect(()=>{},[o,a,l]);let d=l.length>0,m=n.trim().length>0,x=(d||m)&&!o&&!a;return!o||d||m?(0,r.jsxs)("div",{className:"p-4 h-full flex flex-col space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white/80",children:"Otimizador de Prompt"}),(0,r.jsx)("p",{className:"text-sm text-white/60 mt-1",children:"Refine seu prompt com feedback do chat ou instru\xe7\xf5es diretas."})]}),d&&(0,r.jsx)("button",{onClick:i,disabled:a,className:"text-xs text-white/60 hover:text-red-400",children:"Limpar Corre\xe7\xf5es"})]}),(0,r.jsxs)("div",{className:"flex-grow flex flex-col space-y-4 overflow-hidden",children:[(0,r.jsx)("div",{className:"flex-1 flex flex-col min-h-0 ".concat(d?"":"justify-center"),children:d?(0,r.jsx)("div",{className:"bg-white/5 border border-white/10 rounded-md overflow-y-auto p-2 space-y-3 h-full",children:l.map(e=>(0,r.jsxs)("div",{className:"bg-white/5 p-3 rounded-lg text-sm",children:[(0,r.jsxs)("p",{className:"text-white/60",children:[(0,r.jsx)("span",{className:"font-semibold text-white/80",children:"Usu\xe1rio:"})," ",e.userQuery]}),(0,r.jsxs)("p",{className:"text-red-400/80 mt-2 line-through",children:[(0,r.jsx)("span",{className:"font-semibold text-red-300",children:"Agente (Antes):"})," ",e.originalResponse]}),(0,r.jsxs)("p",{className:"text-green-400/90 mt-1",children:[(0,r.jsx)("span",{className:"font-semibold text-green-300",children:"Agente (Ideal):"})," ",e.correctedResponse]})]},e.id))}):(0,r.jsx)("div",{className:"text-white/40 text-center text-sm italic border border-dashed border-white/10 rounded-md p-4",children:"Nenhuma corre\xe7\xe3o do chat ainda. Interaja e marque respostas incorretas para adicion\xe1-las aqui."})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Instru\xe7\xf5es Adicionais (Opcional)"}),(0,r.jsx)("textarea",{value:n,onChange:e=>c(e.target.value),placeholder:"Ex: Torne o tom mais emp\xe1tico, reduza o tamanho, foque mais nas regras...",className:"w-full p-3 bg-white/5 border border-white/10 rounded-md text-white/80 placeholder-white/40 focus:ring-2 focus:ring-emerald-500 focus:border-transparent resize-none h-24 text-sm",disabled:a})]})]}),(0,r.jsx)("button",{onClick:t,disabled:!x,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3 px-4 rounded-lg transition disabled:bg-white/20 disabled:cursor-not-allowed flex items-center justify-center text-lg",children:a?(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Otimizando..."]}):"Otimizar Prompt"})]}):(0,r.jsx)("div",{className:"p-4 h-full flex items-center justify-center text-white/40 text-center",children:"Gere ou selecione um prompt para ativar o otimizador."})},C=e=>{let{messages:t,isRecording:a,onToggleRecording:o,isAssistantLoading:l,error:i,isApiKeySelected:n,onSelectKey:c}=e,d=(0,s.useRef)(null);return((0,s.useEffect)(()=>{var e;null==(e=d.current)||e.scrollIntoView({behavior:"smooth"})},[t]),n)?(0,r.jsxs)("div",{className:"p-4 h-full flex flex-col space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white/80",children:"Assistente"}),(0,r.jsx)("p",{className:"text-sm text-white/60 mt-1",children:"Use a voz para preencher o formul\xe1rio \xe0 esquerda."})]}),(0,r.jsxs)("div",{className:"flex-grow bg-white/5 rounded-lg p-2 flex flex-col space-y-2 overflow-y-auto",children:[t.map((e,t)=>(0,r.jsx)("div",{className:"flex ".concat("user"===e.author?"justify-end":"justify-start"),children:(0,r.jsx)("div",{className:"rounded-lg px-3 py-2 max-w-xs lg:max-w-md ".concat("user"===e.author?"bg-emerald-600 text-white":"bg-white/10 text-white/80"),children:(0,r.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.text})})},t)),0===t.length&&!a&&!l&&(0,r.jsx)("div",{className:"flex-grow flex items-center justify-center text-white/40 text-center px-4",children:"Pressione o microfone para gravar um comando e preencher o formul\xe1rio."}),l&&(0,r.jsx)("div",{className:"flex justify-start",children:(0,r.jsx)("div",{className:"rounded-lg px-3 py-2 bg-white/10 text-white/80",children:(0,r.jsx)("span",{className:"animate-pulse",children:"Processando..."})})}),(0,r.jsx)("div",{ref:d})]}),i&&(0,r.jsx)("p",{className:"text-sm text-red-400 text-center",children:i}),(0,r.jsxs)("div",{className:"flex flex-col space-y-2 items-center pt-2",children:[(0,r.jsx)("button",{onClick:o,disabled:l,className:"p-4 rounded-full transition-colors disabled:bg-white/20 disabled:cursor-not-allowed ".concat(a?"bg-red-500 hover:bg-red-600 animate-pulse":"bg-emerald-600 hover:bg-emerald-700"),children:(0,r.jsx)("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})}),(0,r.jsx)("p",{className:"text-xs text-white/60 h-4",children:l?"Processando \xe1udio...":a?"Gravando... Pressione para parar.":"Pressione para gravar."})]})]}):(0,r.jsxs)("div",{className:"p-6 h-full flex flex-col items-center justify-center text-center",children:[(0,r.jsxs)("svg",{className:"w-16 h-16 text-emerald-500 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 7h2a2 2 0 012 2v6a2 2 0 01-2 2h-2m-6 0H7a2 2 0 01-2-2V9a2 2 0 012-2h2m-6 0V7a2 2 0 012-2h2"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6"})]}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-white/80",children:"Requer Chave de API"}),(0,r.jsx)("p",{className:"text-sm text-white/60 mt-2 max-w-sm",children:"Para usar o assistente de IA por voz, \xe9 necess\xe1rio selecionar uma chave de API para cobrir os custos de uso."}),(0,r.jsx)("button",{onClick:c,className:"mt-6 bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-2 px-6 rounded-lg transition-colors",children:"Selecionar Chave de API"}),(0,r.jsx)("a",{href:"https://ai.google.dev/gemini-api/docs/billing",target:"_blank",rel:"noopener noreferrer",className:"mt-3 text-xs text-white/40 hover:text-white/60 underline",children:"Saiba mais sobre o faturamento"}),i&&(0,r.jsx)("p",{className:"text-sm text-red-400 text-center mt-4",children:i})]})},L=e=>{let{isOpen:t,onClose:a,onConfirm:o}=e,[l,i]=(0,s.useState)("");return t?(0,r.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"bg-black/90 backdrop-blur-sm p-6 rounded-xl shadow-2xl w-full max-w-2xl border border-white/10 animate-in fade-in zoom-in duration-200",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Colar Prompt Existente"}),(0,r.jsx)("button",{onClick:a,className:"text-white/60 hover:text-white transition-colors",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsx)("p",{className:"text-sm text-white/60 mb-3",children:"Cole abaixo o texto do prompt que voc\xea deseja testar ou otimizar."}),(0,r.jsx)("textarea",{className:"w-full h-64 p-4 bg-white/5 text-white/80 border border-white/10 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent resize-none font-mono text-sm",placeholder:"Cole seu prompt aqui...",value:l,onChange:e=>i(e.target.value),autoFocus:!0}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,r.jsx)("button",{onClick:a,className:"px-4 py-2 text-white/80 hover:bg-white/10 rounded-lg transition-colors font-medium",children:"Cancelar"}),(0,r.jsxs)("button",{onClick:()=>{l.trim()&&(o(l),i(""),a())},disabled:!l.trim(),className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),(0,r.jsx)("span",{children:"Carregar Prompt"})]})]})]})}):null},E=e=>{let{isOpen:t,onClose:a,content:o,isLoading:l,error:i,onDownload:n}=e,[c,d]=(0,s.useState)(""),[m,x]=(0,s.useState)(!1),h=(0,s.useRef)(null);if((0,s.useEffect)(()=>{let e=e=>{h.current&&!h.current.contains(e.target)&&x(!1)};return t&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[t,h]),!t)return null;let u=e=>{n(e),x(!1)};return(0,r.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"bg-black/90 backdrop-blur-sm p-6 rounded-xl shadow-2xl w-full max-w-3xl border border-white/10 animate-in fade-in zoom-in duration-200 flex flex-col",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-white tracking-tight",children:"Explica\xe7\xe3o do Prompt"}),(0,r.jsx)("button",{onClick:a,className:"text-white/60 hover:text-white transition-colors",children:(0,r.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center h-64",children:[(0,r.jsxs)("svg",{className:"animate-spin h-10 w-10 text-emerald-400 mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,r.jsx)("p",{className:"text-lg text-white/80",children:"Analisando e gerando documenta\xe7\xe3o..."})]}):i?(0,r.jsxs)("div",{className:"m-4 text-red-400 p-4 bg-red-900 bg-opacity-50 rounded-md",children:[(0,r.jsx)("h3",{className:"font-bold",children:"Erro na Gera\xe7\xe3o da Explica\xe7\xe3o"}),(0,r.jsx)("p",{children:i})]}):(0,r.jsx)("div",{className:"w-full h-96 p-4 bg-white/5 text-white/80 border border-white/10 rounded-lg resize-none text-sm overflow-y-auto",children:(0,r.jsx)("pre",{className:"whitespace-pre-wrap break-words font-sans",children:o})}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,r.jsx)("button",{onClick:a,className:"px-4 py-2 text-white/80 hover:bg-white/10 rounded-lg transition-colors font-medium",children:"Fechar"}),(0,r.jsx)("button",{onClick:()=>{o&&navigator.clipboard.writeText(o).then(()=>{d("Copiado!"),setTimeout(()=>d(""),2e3)},()=>{d("Falha."),setTimeout(()=>d(""),2e3)})},disabled:l||!!i||!o,className:"px-6 py-2 bg-white/10 hover:bg-white/20 text-white font-bold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c||"Copiar Texto"}),(0,r.jsxs)("div",{className:"relative",ref:h,children:[(0,r.jsxs)("button",{onClick:()=>x(e=>!e),disabled:l||!!i||!o,className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:["Baixar",(0,r.jsx)("svg",{className:"w-5 h-5 ml-2 -mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),m&&(0,r.jsxs)("div",{className:"absolute bottom-full right-0 mb-2 w-32 bg-white/10 border border-white/20 rounded-md shadow-lg z-20 backdrop-blur-sm",children:[(0,r.jsx)("button",{onClick:()=>u("txt"),className:"block w-full text-left px-4 py-2 text-sm text-white/80 hover:bg-white/20",children:"Baixar TXT"}),(0,r.jsx)("button",{onClick:()=>u("pdf"),className:"block w-full text-left px-4 py-2 text-sm text-white/80 hover:bg-white/20",children:"Baixar PDF"})]})]})]})]})})};var S=a(3217);let z=e=>{let{currentWorkspaceId:t,onWorkspaceChange:a,onWorkspaceCreated:o}=e,[l,i]=(0,s.useState)([]),[n,c]=(0,s.useState)(!0),[d,m]=(0,s.useState)(!1),[x,h]=(0,s.useState)(null),[u,p]=(0,s.useState)(""),[v,w]=(0,s.useState)(""),[b,g]=(0,s.useState)(!1),[f,j]=(0,s.useState)(null);(0,s.useEffect)(()=>{N()},[]);let N=async()=>{try{c(!0);let e=await (0,S.k0)();if(i(e),!t&&e.length>0){let t=e.find(e=>e.is_default)||e[0];t&&a(t.id)}}catch(e){console.error("Erro ao carregar workspaces:",e),j(e.message||"Erro ao carregar workspaces")}finally{c(!1)}},k=async()=>{if(!u.trim())return void j("Nome do workspace n\xe3o pode estar vazio");try{m(!0),j(null);let e=await (0,S.sK)(u.trim());await N(),a(e.id),await (0,S.$1)(e.id),g(!1),p(""),o&&o()}catch(e){console.error("Erro ao criar workspace:",e),j(e.message||"Erro ao criar workspace")}finally{m(!1)}},y=async e=>{if(!v.trim())return void j("Nome do workspace n\xe3o pode estar vazio");try{j(null),await (0,S.tO)(e,{name:v.trim()}),await N(),h(null),w("")}catch(e){console.error("Erro ao renomear workspace:",e),j(e.message||"Erro ao renomear workspace")}},C=async e=>{if(confirm("Tem certeza que deseja excluir este workspace? Os prompts dentro dele permanecer\xe3o, mas n\xe3o estar\xe3o associados a um workspace."))try{if(j(null),await (0,S.bi)(e),t===e){let t=l.filter(t=>t.id!==e);if(t.length>0){let e=t.find(e=>e.is_default)||t[0];e&&a(e.id)}}await N()}catch(e){console.error("Erro ao deletar workspace:",e),j(e.message||"Erro ao deletar workspace"),alert(e.message||"Erro ao deletar workspace")}},L=async e=>{try{j(null),await (0,S.$1)(e),await N()}catch(e){console.error("Erro ao definir workspace como padr\xe3o:",e),j(e.message||"Erro ao definir workspace como padr\xe3o")}};return n?(0,r.jsx)("div",{className:"flex items-center justify-center p-4",children:(0,r.jsx)("div",{className:"w-6 h-6 border-2 border-emerald-500/30 border-t-emerald-500 rounded-full animate-spin"})}):(l.find(e=>e.id===t),(0,r.jsxs)("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Workspaces"}),(0,r.jsxs)("button",{onClick:()=>g(!0),className:"px-3 py-1.5 bg-emerald-600 hover:bg-emerald-700 text-white text-sm font-semibold rounded-lg transition-colors flex items-center space-x-1",children:[(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,r.jsx)("span",{children:"Novo"})]})]}),f&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-red-900/20 border border-red-500/30 rounded-lg text-red-400 text-sm",children:f}),(0,r.jsx)("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:l.map(e=>(0,r.jsx)("div",{className:"p-3 rounded-lg border transition-all ".concat(t===e.id?"bg-emerald-500/10 border-emerald-500/30":"bg-white/5 border-white/10 hover:bg-white/10"),children:x===e.id?(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"text",value:v,onChange:e=>w(e.target.value),onKeyPress:t=>{"Enter"===t.key?y(e.id):"Escape"===t.key&&(h(null),w(""))},className:"flex-1 px-2 py-1 bg-black/50 border border-white/20 rounded text-white text-sm focus:outline-none focus:border-emerald-500",autoFocus:!0}),(0,r.jsx)("button",{onClick:()=>y(e.id),className:"p-1 text-emerald-400 hover:text-emerald-300",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,r.jsx)("button",{onClick:()=>{h(null),w("")},className:"p-1 text-white/40 hover:text-white/60",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:(0,r.jsx)("button",{onClick:()=>a(e.id),className:"flex-1 text-left min-w-0",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"font-medium text-white truncate",children:e.name}),e.is_default&&(0,r.jsx)("span",{className:"px-2 py-0.5 bg-emerald-500/20 text-emerald-400 text-xs rounded-full",children:"Padr\xe3o"})]})})}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[!e.is_default&&(0,r.jsx)("button",{onClick:()=>L(e.id),className:"p-1 text-white/40 hover:text-emerald-400 transition-colors",title:"Definir como padr\xe3o",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,r.jsx)("button",{onClick:()=>{w(e.name),h(e.id)},className:"p-1 text-white/40 hover:text-white/60 transition-colors",title:"Renomear",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),!e.is_default&&(0,r.jsx)("button",{onClick:()=>C(e.id),className:"p-1 text-white/40 hover:text-red-400 transition-colors",title:"Excluir",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),e.description&&(0,r.jsx)("p",{className:"text-xs text-white/40 truncate",children:e.description})]})},e.id))}),b&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 backdrop-blur-sm",onClick:()=>g(!1),children:(0,r.jsxs)("div",{className:"bg-black/90 backdrop-blur-sm p-6 rounded-xl shadow-2xl w-full max-w-md border border-white/10",onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Criar Novo Workspace"}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-white/80 mb-2",children:"Nome do Workspace"}),(0,r.jsx)("input",{type:"text",value:u,onChange:e=>p(e.target.value),onKeyPress:e=>{"Enter"===e.key?k():"Escape"===e.key&&(g(!1),p(""))},placeholder:"Ex: Projeto Cliente XYZ",className:"w-full px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:border-emerald-500",autoFocus:!0})]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{onClick:k,disabled:d||!u.trim(),className:"flex-1 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 disabled:bg-white/10 disabled:text-white/40 text-white font-semibold rounded-lg transition-colors",children:d?"Criando...":"Criar"}),(0,r.jsx)("button",{onClick:()=>{g(!1),p("")},className:"px-4 py-2 bg-white/10 hover:bg-white/20 text-white font-semibold rounded-lg transition-colors",children:"Cancelar"})]})]})})]}))},M={persona:"Voc\xea \xe9 um assistente de IA prestativo e especialista no assunto X.",objetivo:"O objetivo principal \xe9 responder perguntas sobre Y de forma clara e concisa.",contextoNegocio:'A Empresa X \xe9 l\xedder de mercado em solu\xe7\xf5es de software para pequenas e m\xe9dias empresas. Nosso principal produto \xe9 o "Software Y", que ajuda na automa\xe7\xe3o de tarefas de marketing.',contexto:"O usu\xe1rio est\xe1 interagindo com voc\xea atrav\xe9s de um chat em nosso website. Ele pode ter d\xfavidas sobre funcionalidades, pre\xe7os, ou solu\xe7\xe3o de problemas comuns.",regras:["Seja sempre educado e profissional.","N\xe3o forne\xe7a informa\xe7\xf5es falsas ou enganosas.","Se n\xe3o souber a resposta, admita e diga que n\xe3o pode ajudar com aquela quest\xe3o espec\xedfica."],exemplos:[],variaveisDinamicas:[],ferramentas:[],formatoSaida:"text",masterPromptFormat:"markdown",estruturaSaida:"Responda em um par\xe1grafo curto, seguido por uma lista de pontos chave.",fluxos:[],promptSize:5e3};function R(){var e,t,a,n;(0,o.useSearchParams)(),(0,l.U)();let[c,d]=(0,s.useState)(M),[m,x]=(0,s.useState)(!1),[u,p]=(0,s.useState)(null),[v,w]=(0,s.useState)(!1),[b,R]=(0,s.useState)(null),[P,D]=(0,s.useState)([]),[F,T]=(0,s.useState)(null),[B,A]=(0,s.useState)(null),[W,U]=(0,s.useState)([]),[V,I]=(0,s.useState)(!1),[O,q]=(0,s.useState)(!1),[H,_]=(0,s.useState)([]),[G,K]=(0,s.useState)(""),[X,Z]=(0,s.useState)(!1),[$,J]=(0,s.useState)(!1),[Y,Q]=(0,s.useState)(!1),[ee,et]=(0,s.useState)(""),[ea,er]=(0,s.useState)(null),[es,eo]=(0,s.useState)(null),[el,ei]=(0,s.useState)(!1),[en,ec]=(0,s.useState)(!1),[ed,em]=(0,s.useState)(!1),[ex,eh]=(0,s.useState)(null),[eu,ep]=(0,s.useState)([]),[ev,ew]=(0,s.useState)(!1),eb=(0,s.useRef)(null),eg=(0,s.useRef)([]),[ef,ej]=(0,s.useState)(null),eN=(0,s.useRef)(null),[ek,ey]=(0,s.useState)(!1),[eC,eL]=(0,s.useState)(!0),eE=(0,s.useCallback)(e=>{try{let t=e.text||"";e.functionCalls&&e.functionCalls.length>0&&e.functionCalls.forEach(e=>{let{name:t,args:a}=e;switch(t){case"updatePersona":d(e=>({...e,persona:a.text||e.persona}));break;case"updateObjetivo":d(e=>({...e,objetivo:a.text||e.objetivo}));break;case"updateContextoNegocio":d(e=>({...e,contextoNegocio:a.text||e.contextoNegocio}));break;case"updateContextoInteracao":d(e=>({...e,contexto:a.text||e.contexto}));break;case"addRegra":a.text&&d(e=>({...e,regras:[...e.regras,a.text]}));break;case"addExemplo":a.user&&a.agent&&d(e=>({...e,exemplos:[...e.exemplos,{id:crypto.randomUUID(),user:a.user,agent:a.agent}]}))}}),t&&ep(e=>[...e,{author:"agent",text:t}])}catch(e){console.error("Erro ao processar resposta do assistente:",e),eh(e.message||"Erro ao processar resposta do assistente")}},[]),eS=(0,s.useCallback)(async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0});eb.current=new MediaRecorder(e),eg.current=[],eb.current.ondataavailable=e=>{eg.current.push(e.data)},eb.current.onstop=async()=>{let t=new Blob(eg.current,{type:"audio/webm"}),a=new FileReader;a.readAsDataURL(t),a.onloadend=async()=>{var e;let r=null==(e=a.result)?void 0:e.toString().split(",")[1];if(r){em(!0);try{let e=await (0,h.Rc)(r,t.type);eE(e)}catch(e){eh(e.message||"Erro ao processar \xe1udio.")}finally{em(!1)}}},e.getTracks().forEach(e=>e.stop())},eb.current.start(),ec(!0)}catch(e){console.error("Error starting recording:",e),eh("Falha ao iniciar a grava\xe7\xe3o. Verifique as permiss\xf5es do microfone.")}},[eE]),ez=(0,s.useCallback)(()=>{eb.current&&en&&(eb.current.stop(),ec(!1))},[en]),eM=(0,s.useCallback)(()=>{en?ez():eS()},[en,eS,ez]),eR=(0,s.useCallback)(async()=>{try{window.aistudio&&"function"==typeof window.aistudio.openSelectKey&&(await window.aistudio.openSelectKey(),ew(!0),eh(null))}catch(e){console.error("Error opening API key selection:",e),eh("N\xe3o foi poss\xedvel abrir o seletor de chave de API.")}},[]),eP=(0,s.useCallback)(async()=>{x(!0),p(null);try{var e;let t,a=es||(null==(e=await (0,S.x)())?void 0:e.id)||void 0,r=b;if(r)try{await (0,S.HK)(c,"Prompt ".concat(new Date().toLocaleDateString("pt-BR")),a)}catch(e){console.error("❌ ERRO ao atualizar prompt:",e),p("Erro ao atualizar prompt no banco: ".concat(e.message||"Erro desconhecido",". Verifique o console para mais detalhes.")),x(!1);return}else try{r=(await (0,S.HK)(c,void 0,a)).id,R(r)}catch(e){console.error("❌ ERRO ao criar prompt:",e),p("Erro ao salvar prompt no banco: ".concat(e.message||"Erro desconhecido",". Verifique o console para mais detalhes.")),x(!1);return}let s=await (0,h.BE)(c),o=await (0,f.nG)();if(!o.allowed){p(o.reason||"Limite de vers\xf5es atingido"),x(!1);return}if(!r){p("Erro: ID do prompt n\xe3o encontrado. Tente novamente."),x(!1);return}let l=r;try{t=await (0,S.D$)(l,{content:s,format:c.formatoSaida,masterFormat:c.masterPromptFormat,sourceData:c}),await (0,f.du)();let e=await (0,f.It)();ej(e)}catch(e){console.error("❌ ERRO ao salvar vers\xe3o:",e),p("Erro ao salvar vers\xe3o no banco: ".concat(e.message||"Erro desconhecido",". Verifique o console para mais detalhes.")),x(!1);return}D(e=>[...e,t]),T(t),w(!1),await (0,h.Z4)(s)}catch(e){console.error("❌ Erro ao gerar prompt:",e),p(e.message||"Ocorreu um erro desconhecido. Verifique o console para mais detalhes.")}finally{x(!1)}},[es,b,c]),eD=(0,s.useCallback)(async()=>{if(!await (0,f.x8)("create_version")){let e=await (0,f.vQ)();alert("Limite de vers\xf5es atingido! Voc\xea j\xe1 criou ".concat(e.versionsCount," de ").concat(e.versionsLimit," vers\xf5es permitidas no seu plano este m\xeas. Upgrade para Premium para criar vers\xf5es ilimitadas."));return}if(F&&b&&(0!==H.length||G.trim())){q(!0),p(null);try{let e=await (0,h.K8)(F.content,H,G),t=await (0,f.nG)();if(!t.allowed){p(t.reason||"Limite de vers\xf5es atingido"),q(!1);return}let a=await (0,S.D$)(b,{content:e,format:F.sourceData.formatoSaida,masterFormat:F.sourceData.masterPromptFormat,sourceData:F.sourceData});await (0,f.du)();let r=await (0,f.It)();ej(r),D(e=>[...e,a]),T(a),_([]),K("")}catch(e){console.error("❌ Erro ao otimizar prompt:",e),p((null==e?void 0:e.message)||(null==e?void 0:e.toString())||"Ocorreu um erro desconhecido ao otimizar.")}finally{q(!1)}}},[F,b,H,G]),eF=(0,s.useCallback)(async()=>{Z(!0),p(null);try{let e=(await (0,h.DF)(c)).map(e=>({...e,id:crypto.randomUUID()}));d(t=>({...t,exemplos:[...t.exemplos,...e]}))}catch(e){p(e.message||"Ocorreu um erro ao gerar exemplos.")}finally{Z(!1)}},[c]),eT=(0,s.useCallback)(async e=>{if(!F)return void p("Crie um prompt primeiro antes de enviar mensagens.");let t={author:"user",text:e};if(U(e=>[...e,t]),F.id)try{await (0,S.n3)(F.id,t)}catch(e){console.error("Erro ao salvar mensagem do usu\xe1rio:",e)}I(!0);try{let t=await (0,h.KR)(e),a={author:"agent",text:t};if(U(e=>[...e,a]),F.id)try{await (0,S.n3)(F.id,a)}catch(e){console.error("Erro ao salvar mensagem do agente:",e)}}catch(t){let e={author:"agent",text:"Erro: ".concat(t.message)};if(U(t=>[...t,e]),F.id)try{await (0,S.n3)(F.id,e)}catch(e){console.error("Erro ao salvar mensagem de erro:",e)}}finally{I(!1)}},[F]),eB=(0,s.useCallback)(async()=>{F&&(await (0,h.Z4)(F.content),U([]))},[F]),eA=(0,s.useCallback)(e=>{let t,a=[],r=e,s=/\[CALL:\s*([a-zA-Z_][a-zA-Z0-9_]*)\s*\(([^)]*)\)\]/gi;for(;null!==(t=s.exec(e));){let e=t[1],s=t[2],o={};try{if(s.trim().startsWith("{")||s.includes(":")){let e=s.match(/\{[\s\S]*\}/);e?o=JSON.parse(e[0]):s.split(",").map(e=>e.trim()).forEach(e=>{let[t,...a]=e.split(":");if(t&&a.length>0){let e=a.join(":").trim().replace(/^['"]|['"]$/g,"");try{o[t.trim()]=JSON.parse(e)}catch(a){o[t.trim()]=e}}})}else s.trim()&&(o={value:s.trim().replace(/^['"]|['"]$/g,"")})}catch(e){o={raw:s}}a.push({name:e,args:o,rawText:t[0]}),r=r.replace(t[0],"").trim()}return{conversationText:r=r.replace(/\n\s*\n\s*\n/g,"\n\n").trim(),tools:a}},[]),eW=(0,s.useCallback)(e=>e?e.replace(/\{\{\s*\$now\s*\}\}/gi,new Date().toLocaleString("pt-BR")).replace(/\{\{[^}]*\}\}/g,"").replace(/Ø=[^ ]*/g,"").replace(/[^\x20-\x7E\u00A0-\u024F\u1E00-\u1EFF]/g,e=>{let t=e.charCodeAt(0);return 8203===t||8202===t||t>=8192&&t<=8207?"":" "}).replace(/\s+/g," ").trim():"",[]),eU=(0,s.useCallback)(e=>{if(!e||0===Object.keys(e).length)return"(sem argumentos)";try{return Object.entries(e).map(e=>{let[t,a]=e;return"object"==typeof a&&null!==a?"  • ".concat(t,": ").concat(JSON.stringify(a,null,2).replace(/\n/g,"\n    ")):"string"==typeof a&&a.length>100?"  • ".concat(t,": ").concat(a.substring(0,100),"..."):"  • ".concat(t,": ").concat(String(a))}).join("\n")}catch(t){return String(e)}},[]),eV=(0,s.useCallback)(async e=>{if(0===W.length||!F)return;let t="Especialista",a="Agente de IA";try{let e=await (0,S.Rk)();(null==e?void 0:e.full_name)&&(t=e.full_name)}catch(e){console.error("Erro ao buscar nome do especialista:",e)}try{if(c.persona){let e=eW(c.persona),t=e.match(/(?:eu sou (?:a|o)?|meu nome é|sou (?:a|o)?|chamo-me|me chamo)\s+([A-ZÁÉÍÓÚÀÈÌÒÙÂÊÎÔÛÃÕÇ][a-záéíóúàèìòùâêîôûãõç]+)/i);if(t&&t[1])a=t[1];else{let t=e.match(/(?:sou|é)\s+([A-ZÁÉÍÓÚÀÈÌÒÙÂÊÎÔÛÃÕÇ][a-záéíóúàèìòùâêîôûãõç]+(?:\s+[a-záéíóúàèìòùâêîôûãõç]+)?)/i);t&&t[1]&&(a=t[1].trim())}}}catch(e){console.error("Erro ao extrair nome do agente:",e)}let r="LaBPrompT",s="Hist\xf3rico de Chat - Prompt v".concat(F.version),o="Exportado em: ".concat(new Date().toLocaleString("pt-BR"));if("txt"===e){let e=[];W.forEach(t=>{let r="user"===t.author?"Usu\xe1rio":a,{conversationText:s,tools:o}=eA(t.text);if(s.trim()){let t=eW(s);e.push("".concat(r,": ").concat(t))}o.length>0&&"agent"===t.author&&(e.push("\n[Ferramentas Utilizadas por ".concat(r,"]")),o.forEach(t=>{e.push("  • ".concat(t.name));let a=eU(t.args);"(sem argumentos)"!==a&&e.push("    ".concat(a.replace(/\n/g,"\n    ")))}),e.push(""))});let l=new Blob(["".concat(r,"\n").concat(s,"\n\nEspecialista: ").concat(t,"\nAgente: ").concat(a,"\n\n").concat(o,"\n\n").concat(e.join("\n"))],{type:"text/plain;charset=utf-8"}),i=URL.createObjectURL(l),n=document.createElement("a");n.href=i,n.download="historico_chat_v".concat(F.version,".txt"),document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(i)}else{let e=new i.uE({orientation:"portrait",unit:"mm",format:"a4",compress:!0}),l=20,n=e.internal.pageSize.getWidth(),c=e.internal.pageSize.getHeight();e.setFont("helvetica","normal"),e.setFontSize(24),e.setTextColor(16,185,129);let d=eW(r);e.text(d,10,l),l+=10,e.setDrawColor(200,200,200),e.setLineWidth(.5),e.line(10,l,n-10,l),l+=10,e.setFontSize(16),e.setTextColor(0,0,0);let m=eW(s);e.text(m,10,l),l+=8,e.setFontSize(11),e.setTextColor(60,60,60),e.text("Especialista: ".concat(eW(t)),10,l),l+=6,e.text("Agente: ".concat(eW(a)),10,l),l+=8,e.setFontSize(10),e.setTextColor(100,100,100);let x=eW(o);e.text(x,10,l),l+=12,e.setDrawColor(200,200,200),e.setLineWidth(.5),e.line(10,l,n-10,l),l+=10,e.setFontSize(11),W.forEach((t,r)=>{let s="user"===t.author,{conversationText:o,tools:i}=eA(t.text);if(o.trim()){let t=eW(o),r=.7*n,i=e.splitTextToSize(t,r-20),d=6*i.length+16+5;l+d>c-10&&(e.addPage(),l=20);let m=s?n-r-10:10;e.setFillColor(s?16:60,s?185:60,s?129:60),e.setDrawColor(s?16:60,s?185:60,s?129:60),e.roundedRect(m,l,r,d,3,3,"FD"),e.setFontSize(9),e.setTextColor(255,255,255,80);let x=s?"Usu\xe1rio":a;e.text(x,m+8,l+8+5),e.setFontSize(11),e.setTextColor(255,255,255),e.text(i,m+8,l+8+5+6),l+=d+8}if(i.length>0&&!s){let t=n-20,a=15;i.forEach(r=>{let s=eU(r.args),o=e.splitTextToSize(s,t-20);a+=6+4*o.length+4}),l+a>c-10&&(e.addPage(),l=20);let r=l;e.setFillColor(249,250,251),e.setDrawColor(251,191,36),e.setLineWidth(1),e.roundedRect(10,r,t,a,3,3,"FD"),e.setFontSize(10),e.setFont("helvetica","bold"),e.setTextColor(245,158,11),e.text("Ferramentas Utilizadas:",18,r+8);let s=r+15;i.forEach(a=>{e.setFontSize(9),e.setFont("helvetica","bold"),e.setTextColor(0,0,0),e.text("• ".concat(a.name),22,s),s+=6;let r=eU(a.args);if("(sem argumentos)"!==r){let a=e.splitTextToSize(r,t-24);e.setFont("helvetica","normal"),e.setTextColor(40,40,40),e.text(a,26,s),s+=4*a.length+2}else s+=2}),l=s+8}}),e.save("historico_chat_v".concat(F.version,".pdf"))}},[W,F,c]),eI=(0,s.useCallback)((e,t)=>{U(a=>a.map((a,r)=>r===e?{...a,...t}:a))},[]),eO=(0,s.useCallback)((e,t)=>{let a="";for(let t=e-1;t>=0;t--)if("user"===W[t].author){a=W[t].text;break}if(a){let r=W[e];_(e=>[...e,{id:crypto.randomUUID(),userQuery:a,originalResponse:r.text,correctedResponse:t}])}eI(e,{correction:t,isEditing:!1})},[W,eI]),eq=(0,s.useCallback)(e=>{let t=P.find(t=>t.id===e);t&&T(t)},[P]),eH=(0,s.useCallback)(e=>A(e),[]),e_=(0,s.useCallback)(e=>{let t=P.filter(t=>t.id!==e);D(t),B===e&&A(null),(null==F?void 0:F.id)===e&&T(t.length>0?t[t.length-1]:null)},[P,B,F]),eG=(0,s.useCallback)(async e=>{if(e){J(!0),Q(!0),et(""),er(null);try{let t=await (0,h.CB)(e);et(t)}catch(e){er(e.message||"Ocorreu um erro desconhecido ao gerar a explica\xe7\xe3o.")}finally{Q(!1)}}},[]),eK=(0,s.useCallback)(e=>{if(!ee)return;let t="Explicacao_do_Prompt";if("txt"===e){let e=new Blob([ee],{type:"text/plain;charset=utf-8"}),a=URL.createObjectURL(e),r=document.createElement("a");r.href=a,r.download="".concat(t,".txt"),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a)}else{let e=new i.uE,a=15,r=e.internal.pageSize.getWidth()-20;e.setFontSize(18),e.text("Explica\xe7\xe3o do Prompt",10,a),a+=10,ee.split("\n").forEach(t=>{a>280&&(e.addPage(),a=15);let s=(t=t.replace(/\*\*(.*?)\*\*/g,"$1")).startsWith("# "),o=t.startsWith("## "),l=t.startsWith("- ")||/^\d+\.\s/.test(t),i=t;e.setFont("helvetica","normal"),e.setFontSize(10),s?(i=t.substring(2),e.setFont("helvetica","bold"),e.setFontSize(16)):o?(i=t.substring(3),e.setFont("helvetica","bold"),e.setFontSize(14)):l&&(i="  • "+t.replace(/(-|\d+\.)\s/,""));let n=e.splitTextToSize(i,r);e.text(n,10,a),a+=5*n.length,(s||o)&&(a+=3)}),e.save("".concat(t,".pdf"))}},[ee]),eX=(0,s.useCallback)(async(e,t)=>{try{let a="markdown";try{JSON.parse(e),a="json"}catch(e){}let r={...M,persona:t,objetivo:"Prompt importado externamente.",contexto:"Conte\xfado carregado via ".concat(t,"."),masterPromptFormat:a};d(r);let s=b;if(s?await (0,S.HK)(r,"Prompt Importado - ".concat(new Date().toLocaleDateString("pt-BR"))):(s=(await (0,S.HK)(r,t)).id,R(s)),!s)return void p("Erro: ID do prompt n\xe3o encontrado. Tente novamente.");let o=s,l=await (0,S.D$)(o,{content:e,format:"markdown",masterFormat:a,sourceData:r});D(e=>[...e,l]),T(l),w(!1),await (0,h.Z4)(e)}catch(e){console.error("Erro ao carregar prompt externo:",e),p(e.message||"Erro ao importar prompt. Verifique o console para mais detalhes.")}},[b]),eZ=(0,s.useCallback)(()=>{var e;return null==(e=eN.current)?void 0:e.click()},[]),e$=(0,s.useCallback)(e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(!a)return;let r=new FileReader;r.onload=async e=>{var t;let a=null==(t=e.target)?void 0:t.result;a&&await eX(a,"Arquivo Importado")},r.onerror=e=>p("Falha ao ler o arquivo."),r.readAsText(a),e.target&&(e.target.value="")},[eX]),eJ=(0,s.useCallback)(()=>ey(!0),[]),eY=(0,s.useCallback)(async e=>{await eX(e,"Prompt Colado")},[eX]),eQ=(0,s.useCallback)(async()=>{if(!c.persona.trim())return void p("Persona n\xe3o pode estar vazia para salvar no reposit\xf3rio");ei(!0),p(null);try{var e;let t=es||(null==(e=await (0,S.x)())?void 0:e.id)||void 0,a=b;a?await (0,S.HK)(c,"Prompt ".concat(new Date().toLocaleDateString("pt-BR")),t):(a=(await (0,S.HK)(c,void 0,t)).id,R(a)),w(!1),alert("Prompt salvo no reposit\xf3rio com sucesso!")}catch(e){console.error("❌ Erro ao salvar no reposit\xf3rio:",e),p(e.message||"Erro ao salvar no reposit\xf3rio"),alert("Erro ao salvar no reposit\xf3rio: "+(e.message||"Erro desconhecido"))}finally{ei(!1)}},[c,es,b]),e0=(0,s.useCallback)(async e=>{eo(e),D([]),T(null),U([]),d(M),R(null),w(!1);try{let t=await (0,S.ji)(e);if(t&&t.length>0){let e=t[0];R(e.id);let{promptData:a}=await (0,S.XH)(e.id);d(a);let r=await (0,S.Mr)(e.id);if(r&&r.length>0){D(r);let e=r[0];T(e);let t=await (0,S.Zm)(e.id);t&&t.length>0&&U(t),e.content&&await (0,h.Z4)(e.content)}}}catch(e){console.error("❌ Erro ao carregar prompts do workspace:",e),p(e.message||"Erro ao carregar prompts do workspace")}},[]),e1=(0,s.useCallback)(()=>{D([]),T(null),U([]),d(M),R(null),w(!1)},[]),e2=(0,s.useCallback)(async e=>{let t=await (0,f.gg)();if(!t.allowed)return void p(t.reason||"Compartilhamento n\xe3o dispon\xedvel no seu plano");let a=window.location.origin,r="".concat(a,"/chat/").concat(e),s=document.createElement("div");s.className="fixed inset-0 bg-black/70 flex items-center justify-center z-50 backdrop-blur-sm",s.innerHTML='\n            <div class="bg-black/90 backdrop-blur-sm p-6 rounded-xl shadow-2xl w-full max-w-md border border-white/10 animate-in fade-in zoom-in duration-200" style="animation: fadeIn 0.2s ease-out">\n                <div class="flex justify-between items-center mb-4">\n                    <h3 class="text-xl font-bold text-white">Compartilhar Chat</h3>\n                    <button onclick="this.closest(\'.fixed\').remove()" class="text-white/60 hover:text-white transition">\n                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />\n                        </svg>\n                    </button>\n                </div>\n                <p class="text-white/60 text-sm mb-4">\n                    Compartilhe este link para que clientes testem o chat com esta vers\xe3o do prompt:\n                </p>\n                <div class="flex space-x-2 mb-4">\n                    <input\n                        type="text"\n                        value="'.concat(r,'"\n                        readonly\n                        id="shareLinkInput"\n                        class="flex-1 px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-white/80 text-sm"\n                    />\n                    <button\n                        onclick="navigator.clipboard.writeText(\'').concat(r,'\').then(() => { this.textContent = \'Copiado!\'; setTimeout(() => this.closest(\'.fixed\').remove(), 2000); })"\n                        class="bg-emerald-600 hover:bg-emerald-700 text-white font-bold px-4 py-2 rounded-lg transition text-sm"\n                    >\n                        Copiar\n                    </button>\n                </div>\n                <div class="bg-emerald-900/20 border border-emerald-700/50 rounded-lg p-3">\n                    <p class="text-emerald-300 text-xs">\n                        \uD83D\uDCA1 <strong>Dica:</strong> O link abrir\xe1 uma nova aba com o chat conversacional. O cliente poder\xe1 interagir com o agente usando esta vers\xe3o do prompt.\n                    </p>\n                </div>\n            </div>\n        '),s.onclick=e=>{e.target===s&&s.remove()},document.body.appendChild(s);let o=s.querySelector("#shareLinkInput");o&&o.select()},[]);(0,s.useEffect)(()=>{(async()=>{eL(!0);try{let[e,t]=await Promise.all([(0,S.x)(),(0,S.ji)()]);if(e){eo(e.id);let t=await (0,S.ji)(e.id);if(t&&t.length>0){let e=t[0];R(e.id);let[a,r]=await Promise.all([(0,S.XH)(e.id),(0,S.Mr)(e.id)]);if(d(a.promptData),D(r),r&&r.length>0){let e=r[0];T(e),(0,S.Zm)(e.id).then(e=>{e&&e.length>0&&U(e)}).catch(e=>{console.error("Erro ao carregar mensagens:",e)}),e.content&&await (0,h.Z4)(e.content)}}}}catch(e){console.error("Erro ao carregar dados iniciais:",e),p(e.message||"Erro ao carregar dados")}finally{eL(!1)}})()},[]);let e4=m||O;return eC?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-[400px] sm:min-h-[500px] md:min-h-[600px] w-full bg-black",children:(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-4 sm:space-y-6 px-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"w-12 h-12 sm:w-16 sm:h-16 border-4 border-emerald-500/30 rounded-full animate-spin border-t-emerald-500"}),(0,r.jsx)("div",{className:"absolute top-0 left-0 w-16 h-16 border-4 border-transparent border-t-emerald-400 border-r-green-500 rounded-full animate-spin"})]}),(0,r.jsxs)("div",{className:"text-center px-4",children:[(0,r.jsx)("p",{className:"text-white/90 font-medium text-sm sm:text-base md:text-lg",children:"Carregando seus prompts..."}),(0,r.jsx)("p",{className:"text-white/50 text-xs sm:text-sm mt-1 sm:mt-2",children:"Aguarde um momento"})]})]})}):(0,r.jsxs)("div",{className:"h-full w-full overflow-auto bg-black",children:[(0,r.jsx)(E,{isOpen:$,onClose:()=>J(!1),content:ee,isLoading:Y,error:ea,onDownload:eK}),(0,r.jsx)(L,{isOpen:ek,onClose:()=>ey(!1),onConfirm:eY}),(0,r.jsx)("input",{type:"file",ref:eN,onChange:e$,className:"hidden",accept:".txt,.md,.json"}),(0,r.jsxs)("div",{className:"hidden lg:grid lg:grid-cols-12 gap-4 xl:gap-5 2xl:gap-6",children:[(0,r.jsx)("div",{className:"col-span-12 xl:col-span-4 bg-white/5 backdrop-blur-sm rounded-xl xl:rounded-2xl overflow-hidden border border-white/10 shadow-xl flex flex-col",style:{height:"calc(100vh - 180px)"},children:(0,r.jsx)(g,{formData:c,setFormData:e=>{d(e),w(!0)},onGenerate:eP,isLoading:m,onGenerateExamples:eF,isGeneratingExamples:X,activePromptContent:null!=(e=null==F?void 0:F.content)?e:"",onSaveToRepository:eQ,isSavingToRepository:el})}),(0,r.jsxs)("div",{className:"col-span-12 xl:col-span-5 space-y-4 xl:space-y-5 2xl:space-y-6",children:[(0,r.jsx)("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl xl:rounded-2xl overflow-hidden flex flex-col border border-white/10 shadow-xl",style:{height:"calc(50vh - 100px)"},children:(0,r.jsx)(j,{version:F,isLoading:e4,error:u,isValidated:!!B&&(null==F?void 0:F.id)===B,onValidate:eH,onExplain:eG})}),(0,r.jsx)("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl xl:rounded-2xl overflow-hidden border border-white/10 shadow-xl flex flex-col",style:{height:"calc(50vh - 100px)"},children:(0,r.jsx)(k,{messages:W,onSendMessage:eT,onClearChat:eB,isLoading:V,disabled:!F||e4,onUpdateMessage:eI,onSaveCorrection:eO,onDownloadChat:eV})})]}),(0,r.jsxs)("div",{className:"col-span-12 xl:col-span-3 space-y-4 xl:space-y-5 2xl:space-y-6",children:[(0,r.jsx)("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl xl:rounded-2xl overflow-hidden border border-white/10 shadow-xl flex flex-col",style:{minHeight:"150px"},children:(0,r.jsx)(z,{currentWorkspaceId:es,onWorkspaceChange:e0,onWorkspaceCreated:e1})}),(0,r.jsx)("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl xl:rounded-2xl overflow-hidden border border-white/10 shadow-xl flex flex-col",style:{height:"calc(35vh - 80px)"},children:(0,r.jsx)(N,{history:P,activeVersionId:null!=(t=null==F?void 0:F.id)?t:null,onSelectVersion:eq,onDeleteVersion:e_,validatedVersionId:B,onImport:eZ,onPaste:eJ,onShare:e2})}),(0,r.jsx)("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl xl:rounded-2xl overflow-hidden border border-white/10 shadow-xl flex flex-col",style:{minHeight:"150px"},children:(0,r.jsx)(y,{onOptimize:eD,isLoading:O,disabled:!F||e4,optimizationPairs:H,onClearCorrections:()=>_([]),manualInstructions:G,onManualInstructionsChange:K})}),(0,r.jsx)("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl xl:rounded-2xl overflow-hidden border border-white/10 shadow-xl flex flex-col",style:{height:"calc(35vh - 80px)"},children:(0,r.jsx)(C,{messages:eu,isRecording:en,onToggleRecording:eM,isAssistantLoading:ed,error:ex,isApiKeySelected:ev,onSelectKey:eR})})]})]}),(0,r.jsxs)("div",{className:"lg:hidden space-y-3 sm:space-y-4 p-3 sm:p-4",children:[(0,r.jsx)("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl overflow-hidden border border-white/10 shadow-xl w-full",children:(0,r.jsx)(g,{formData:c,setFormData:e=>{d(e),w(!0)},onGenerate:eP,isLoading:m,onGenerateExamples:eF,isGeneratingExamples:X,activePromptContent:null!=(a=null==F?void 0:F.content)?a:"",onSaveToRepository:eQ,isSavingToRepository:el})}),(0,r.jsx)("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl overflow-hidden flex flex-col border border-white/10 shadow-xl min-h-[300px] sm:min-h-[400px] w-full",children:(0,r.jsx)(j,{version:F,isLoading:e4,error:u,isValidated:!!B&&(null==F?void 0:F.id)===B,onValidate:eH,onExplain:eG})}),(0,r.jsx)("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl overflow-hidden border border-white/10 shadow-xl min-h-[250px] sm:min-h-[300px] w-full",children:(0,r.jsx)(N,{history:P,activeVersionId:null!=(n=null==F?void 0:F.id)?n:null,onSelectVersion:eq,onDeleteVersion:e_,validatedVersionId:B,onImport:eZ,onPaste:eJ,onShare:e2})}),(0,r.jsx)("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl overflow-hidden border border-white/10 shadow-xl min-h-[250px] sm:min-h-[300px] w-full",children:(0,r.jsx)(y,{onOptimize:eD,isLoading:O,disabled:!F||e4,optimizationPairs:H,onClearCorrections:()=>_([]),manualInstructions:G,onManualInstructionsChange:K})}),(0,r.jsx)("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl overflow-hidden border border-white/10 shadow-xl min-h-[300px] sm:min-h-[400px] w-full",children:(0,r.jsx)(k,{messages:W,onSendMessage:eT,onClearChat:eB,isLoading:V,disabled:!F||e4,onUpdateMessage:eI,onSaveCorrection:eO,onDownloadChat:eV})}),(0,r.jsx)("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl overflow-hidden border border-white/10 shadow-xl min-h-[250px] sm:min-h-[300px] w-full",children:(0,r.jsx)(C,{messages:eu,isRecording:en,onToggleRecording:eM,isAssistantLoading:ed,error:ex,isApiKeySelected:ev,onSelectKey:eR})})]})]})}function P(){return(0,r.jsx)(s.Suspense,{fallback:(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen text-white",children:"Carregando..."}),children:(0,r.jsx)(R,{})})}},8525:(e,t,a)=>{"use strict";a.d(t,{U:()=>o});var r=a(6010),s=a(5704);function o(){let e=s.env.NEXT_PUBLIC_SUPABASE_URL,t=s.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;return e&&t||console.warn("⚠️ Vari\xe1veis de ambiente do Supabase n\xe3o configuradas. O cliente Supabase pode n\xe3o funcionar corretamente."),(0,r.createBrowserClient)(e||"",t||"",{db:{schema:"public"},auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},global:{headers:{"x-client-info":"labprompt-nextjs"}}})}}},e=>{e.O(0,[798,930,33,524,503,163,241,217,517,441,255,358],()=>e(e.s=116)),_N_E=e.O()}]);