(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{2418:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m,dynamic:()=>c});var r=a(5155),n=a(2115),o=a(2619),i=a.n(o),s=a(63),l=a(8525),d=a(8231);let c="force-dynamic";function m(){let e=(0,s.useRouter)(),t=(0,l.U)();(0,n.useEffect)(()=>{(async()=>{let{data:{session:a}}=await t.auth.getSession();a&&e.replace("/dashboard")})();let{data:{subscription:a}}=t.auth.onAuthStateChange((t,a)=>{a&&e.replace("/dashboard")});return()=>a.unsubscribe()},[e,t]);let[a,o]=(0,n.useState)({name:"",email:"",password:"",confirmPassword:""}),[c,m]=(0,n.useState)(null),[u,p]=(0,n.useState)(null),[h,f]=(0,n.useState)(!1),[x,w]=(0,n.useState)(null),[g,b]=(0,n.useState)(!1),v=async e=>{e.preventDefault(),m(null),p(null);let r=(0,d.Hc)(a.email),n=(0,d.Eb)(r,"signup");if(!n.allowed){m("Muitas tentativas de cadastro. Tente novamente em ".concat(n.retryAfter," minutos.")),(0,d.h4)({type:"rate_limit_exceeded",identifier:r,timestamp:Date.now(),details:{action:"signup"}}),f(!1);return}if(!a.name||!a.email||!a.password||!a.confirmPassword){m("Por favor, preencha todos os campos."),f(!1);return}let i=(0,d.yS)((0,d.jZ)(a.name.trim()));if(!i.valid){m(i.error||"Nome inv\xe1lido."),f(!1);return}if(!(0,d.DT)(a.email.trim())){m("Por favor, insira um e-mail v\xe1lido."),f(!1);return}let s=(0,d.Oj)(a.password);if(!s.valid){m(s.errors[0]||"Senha inv\xe1lida."),f(!1);return}if(a.password!==a.confirmPassword){m("As senhas n\xe3o coincidem."),f(!1);return}(0,d.h4)({type:"signup_attempt",identifier:r,timestamp:Date.now()}),f(!0);try{let e=(0,d.jZ)(a.name.trim(),100),n=a.email.trim().toLowerCase(),i=window.location.origin,{data:s,error:l}=await t.auth.signUp({email:n,password:a.password,options:{data:{full_name:e},emailRedirectTo:"".concat(i,"/auth/callback")}});if(l){(0,d.h4)({type:"suspicious_activity",identifier:r,timestamp:Date.now(),details:{error:l.message,action:"signup_failed"}});let e=l.message||"";e.includes("User already registered")||e.includes("already registered")||e.includes("email_already_exists")?m("Este e-mail j\xe1 est\xe1 cadastrado. Tente fazer login ou recuperar sua senha."):e.includes("Failed to fetch")||e.includes("NetworkError")?m("❌ Erro de conex\xe3o com o banco de dados.\n\n⚠️ IMPORTANTE: Este projeto usa Next.js!\n\n\uD83D\uDD27 Vari\xe1veis de ambiente devem ter prefixo NEXT_PUBLIC_:\n   ✅ NEXT_PUBLIC_SUPABASE_URL\n   ✅ NEXT_PUBLIC_SUPABASE_ANON_KEY\n\n\uD83D\uDCCB Configure na Vercel: Settings → Environment Variables"):e.includes("Password")||e.includes("password")?e.includes("length")||e.includes("6")?m("A senha deve atender aos requisitos de seguran\xe7a (m\xednimo 8 caracteres, mai\xfascula, min\xfascula, n\xfamero e caractere especial)."):m("A senha n\xe3o atende aos requisitos de seguran\xe7a."):m("Erro ao criar conta: ".concat(l.message||"Por favor, tente novamente.")),f(!1);return}(null==s?void 0:s.user)&&((0,d.PO)(r),w(n),p("✅ Conta criada com sucesso!\n\n\uD83D\uDCE7 Enviamos um email de confirma\xe7\xe3o para voc\xea. Por favor, verifique sua caixa de entrada e clique no link de confirma\xe7\xe3o para ativar sua conta.\n\n⚠️ Se n\xe3o encontrar o email, verifique tamb\xe9m a pasta de spam/lixo eletr\xf4nico."),(0,d.h4)({type:"signup_success",identifier:r,timestamp:Date.now()}),o({name:"",email:"",password:"",confirmPassword:""}))}catch(e){console.error("Erro ao criar conta:",e),m("Erro inesperado. Por favor, tente novamente.")}finally{f(!1)}},N=async()=>{if(x){b(!0),m(null);try{let{error:e}=await t.auth.resend({type:"signup",email:x,options:{emailRedirectTo:"".concat(window.location.origin,"/auth/callback")}});e?m("Erro ao reenviar email. Tente novamente."):p("✅ Email de confirma\xe7\xe3o reenviado com sucesso! Verifique sua caixa de entrada.")}catch(e){console.error("Erro ao reenviar email:",e),m("Erro ao reenviar email. Tente novamente.")}finally{b(!1)}}};return(0,r.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center px-4 py-12",children:(0,r.jsxs)("div",{className:"w-full max-w-md",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-emerald-400 to-green-500 rounded-xl mb-4",children:(0,r.jsx)("svg",{className:"w-8 h-8 text-black",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Criar Conta"}),(0,r.jsx)("p",{className:"text-white/60",children:"Comece sua jornada de engenharia de prompts"})]}),(0,r.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[u&&(0,r.jsxs)("div",{className:"bg-emerald-500/10 border border-emerald-500/50 rounded-lg p-4 text-emerald-400 text-sm whitespace-pre-line mb-4",children:[u,x&&(0,r.jsx)("button",{onClick:N,disabled:g,className:"mt-3 w-full py-2 bg-emerald-500/20 hover:bg-emerald-500/30 text-emerald-400 rounded-lg transition-colors disabled:opacity-50 text-sm font-medium",children:g?"Reenviando...":"Reenviar Email de Confirma\xe7\xe3o"})]}),c&&(0,r.jsx)("div",{className:"bg-red-500/10 border border-red-500/50 rounded-lg p-4 text-red-400 text-sm whitespace-pre-line mb-4",children:c}),(0,r.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-white/80 mb-2",children:"Nome Completo"}),(0,r.jsx)("input",{id:"name",type:"text",value:a.name,onChange:e=>o({...a,name:e.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-emerald-500",placeholder:"Seu nome completo",required:!0,disabled:h})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-white/80 mb-2",children:"E-mail"}),(0,r.jsx)("input",{id:"email",type:"email",value:a.email,onChange:e=>o({...a,email:e.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-emerald-500",placeholder:"seu@email.com",required:!0,disabled:h})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-white/80 mb-2",children:"Senha"}),(0,r.jsx)("input",{id:"password",type:"password",value:a.password,onChange:e=>o({...a,password:e.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-emerald-500",placeholder:"••••••••",required:!0,disabled:h}),(0,r.jsx)("p",{className:"mt-1 text-xs text-white/50",children:"M\xednimo 8 caracteres, incluindo mai\xfascula, min\xfascula, n\xfamero e caractere especial"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-white/80 mb-2",children:"Confirmar Senha"}),(0,r.jsx)("input",{id:"confirmPassword",type:"password",value:a.confirmPassword,onChange:e=>o({...a,confirmPassword:e.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-emerald-500",placeholder:"••••••••",required:!0,disabled:h})]}),(0,r.jsx)("button",{type:"submit",disabled:h,className:"w-full py-3 bg-emerald-500 hover:bg-emerald-600 text-black font-semibold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Criando conta...":"Criar Conta"})]}),(0,r.jsx)("div",{className:"mt-6 text-center",children:(0,r.jsxs)("p",{className:"text-white/60 text-sm",children:["J\xe1 tem uma conta?"," ",(0,r.jsx)(i(),{href:"/login",className:"text-emerald-400 hover:text-emerald-300 font-medium",children:"Fazer login"})]})})]})]})})}},5107:(e,t,a)=>{Promise.resolve().then(a.bind(a,2418))},8231:(e,t,a)=>{"use strict";a.d(t,{A_:()=>p,DT:()=>d,Eb:()=>o,Gg:()=>f,Hc:()=>g,Oj:()=>c,PO:()=>i,Zm:()=>l,aJ:()=>u,h4:()=>h,jZ:()=>s,yS:()=>m,zf:()=>w});let r=new Map,n={MAX_LOGIN_ATTEMPTS:5,BLOCK_DURATION_MINUTES:15,WINDOW_MINUTES:15,MAX_REQUESTS_PER_MINUTE:60,MAX_SIGNUP_PER_HOUR:5};function o(e,t){let a=Date.now(),o=r.get(e);if(!o)return r.set(e,{attempts:1,resetTime:a+60*n.WINDOW_MINUTES*1e3,blocked:!1}),{allowed:!0};if(o.blocked&&a<o.resetTime)return{allowed:!1,retryAfter:Math.ceil((o.resetTime-a)/1e3/60)};if(a>o.resetTime)return r.set(e,{attempts:1,resetTime:a+60*n.WINDOW_MINUTES*1e3,blocked:!1}),{allowed:!0};let i="login"===t?n.MAX_LOGIN_ATTEMPTS:"signup"===t?n.MAX_SIGNUP_PER_HOUR:n.MAX_REQUESTS_PER_MINUTE;return o.attempts>=i?(o.blocked=!0,o.resetTime=a+60*n.BLOCK_DURATION_MINUTES*1e3,{allowed:!1,retryAfter:n.BLOCK_DURATION_MINUTES}):(o.attempts++,{allowed:!0})}function i(e){r.delete(e)}function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4;if(!e||"string"!=typeof e)return"";let a=e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").replace(/[\x00-\x1F\x7F]/g,"").trim();return a.length>t&&(a=a.substring(0,t)),a}function l(e){let t={...e};for(let e of["__proto__","constructor","prototype"])delete t[e];return t}setInterval(function(){let e=Date.now();for(let[t,a]of r.entries())e>a.resetTime&&!a.blocked&&r.delete(t)},18e5);let d=function(e){return!!e&&"string"==typeof e&&/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e)&&e.length<=254};function c(e){let t=[];if(!e||"string"!=typeof e)return{valid:!1,errors:["Senha \xe9 obrigat\xf3ria"],strength:"weak"};e.length<8&&t.push("Senha deve ter pelo menos 8 caracteres"),e.length>128&&t.push("Senha muito longa (m\xe1ximo 128 caracteres)");let a=/[A-Z]/.test(e),r=/[a-z]/.test(e),n=/\d/.test(e),o=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e);a||t.push("Senha deve conter pelo menos uma letra mai\xfascula"),r||t.push("Senha deve conter pelo menos uma letra min\xfascula"),n||t.push("Senha deve conter pelo menos um n\xfamero"),o||t.push("Senha deve conter pelo menos um caractere especial"),["password","12345678","qwerty","abc123","password123","admin","senha","123456","123456789","1234567890"].some(t=>e.toLowerCase().includes(t))&&t.push("Senha muito comum. Escolha uma senha mais segura");let i="weak",s=[a,r,n,o,e.length>=12].filter(Boolean).length;return s>=4&&e.length>=12?i="strong":s>=3&&(i="medium"),{valid:0===t.length,errors:t,strength:i}}function m(e){return e&&"string"==typeof e?e.length<2?{valid:!1,error:"Nome deve ter pelo menos 2 caracteres"}:e.length>100?{valid:!1,error:"Nome muito longo (m\xe1ximo 100 caracteres)"}:/^[a-zA-ZÀ-ÿ\u00f1\u00d1\s\-']+$/.test(e)?{valid:!0}:{valid:!1,error:"Nome cont\xe9m caracteres inv\xe1lidos"}:{valid:!1,error:"Nome \xe9 obrigat\xf3rio"}}function u(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e4;return e&&"string"==typeof e?e.length>t?{valid:!1,error:"Texto muito longo (m\xe1ximo ".concat(t," caracteres)")}:{valid:!0,sanitized:s(e,t)}:{valid:!1,error:"Texto \xe9 obrigat\xf3rio"}}function h(e){console.warn("\uD83D\uDD12 Security Event:",e)}function f(e){return e.size>0xa00000?{valid:!1,error:"Arquivo muito grande. Tamanho m\xe1ximo: ".concat(10,"MB")}:{valid:!0}}let x=["application/pdf","text/plain","text/markdown","text/x-markdown","text/html","text/csv","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"];function w(e){return x.includes(e.type)||e.name.toLowerCase().endsWith(".md")||e.name.toLowerCase().endsWith(".txt")||e.name.toLowerCase().endsWith(".csv")||e.name.toLowerCase().endsWith(".xlsx")||e.name.toLowerCase().endsWith(".xls")?{valid:!0}:{valid:!1,error:"Tipo de arquivo n\xe3o permitido. Use PDF, TXT, MD, HTML, CSV, XLSX, XLS, DOC ou DOCX."}}function g(e,t){return t?"".concat(e||"anonymous","_").concat(t):e||"anonymous"}},8525:(e,t,a)=>{"use strict";a.d(t,{U:()=>o});var r=a(6010),n=a(5704);function o(){let e=n.env.NEXT_PUBLIC_SUPABASE_URL,t=n.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;return e&&t||console.warn("⚠️ Vari\xe1veis de ambiente do Supabase n\xe3o configuradas. O cliente Supabase pode n\xe3o funcionar corretamente."),(0,r.createBrowserClient)(e||"",t||"",{db:{schema:"public"},auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},global:{headers:{"x-client-info":"labprompt-nextjs"}}})}}},e=>{e.O(0,[503,163,619,441,255,358],()=>e(e.s=5107)),_N_E=e.O()}]);