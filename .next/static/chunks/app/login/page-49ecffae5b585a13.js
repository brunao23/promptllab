(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{5404:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m,dynamic:()=>c});var r=a(5155),n=a(2115),o=a(2619),i=a.n(o),s=a(63),l=a(8525),d=a(8231);let c="force-dynamic";function m(){let e=(0,s.useRouter)(),t=(0,l.U)();(0,n.useEffect)(()=>{(async()=>{let{data:{session:a}}=await t.auth.getSession();a&&e.replace("/dashboard")})();let{data:{subscription:a}}=t.auth.onAuthStateChange((t,a)=>{a&&e.replace("/dashboard")});return()=>a.unsubscribe()},[e,t]);let[a,o]=(0,n.useState)({email:"",password:""}),[c,m]=(0,n.useState)(null),[u,p]=(0,n.useState)(!1),h=async r=>{r.preventDefault(),m(null),p(!0);try{if(!a.email||!a.password){m("Por favor, preencha todos os campos."),p(!1);return}let r=a.email.trim().toLowerCase();if(!(0,d.DT)(r)){m("Por favor, insira um e-mail v\xe1lido."),p(!1);return}let n=(0,d.Hc)(r),o=(0,d.Eb)(n,"login");if(!o.allowed){m("Muitas tentativas de login. Tente novamente em ".concat(o.retryAfter," minutos.")),(0,d.h4)({type:"rate_limit_exceeded",identifier:n,timestamp:Date.now(),details:{action:"login",email:r}}),p(!1);return}(0,d.h4)({type:"login_attempt",identifier:n,timestamp:Date.now()});let{data:i,error:s}=await t.auth.signInWithPassword({email:r,password:a.password});if(s){(0,d.h4)({type:"login_failed",identifier:n,timestamp:Date.now(),details:{error:s.message,email:r}});let e=s.message||"";e.includes("Invalid login credentials")||e.includes("Invalid credentials")?m("E-mail ou senha incorretos. Tente novamente."):e.includes("Email not confirmed")||e.includes("email_not_confirmed")?m("\uD83D\uDD12 Por favor, confirme seu e-mail antes de fazer login.\n\n\uD83D\uDCE7 Verifique sua caixa de entrada e clique no link de confirma\xe7\xe3o enviado por email."):e.includes("Too many requests")?m("Muitas tentativas. Por favor, aguarde alguns minutos antes de tentar novamente."):e.includes("Failed to fetch")||e.includes("NetworkError")?m("❌ Erro de conex\xe3o com o banco de dados.\n\n⚠️ IMPORTANTE: Este projeto usa Next.js!\n\n\uD83D\uDD27 Vari\xe1veis de ambiente devem ter prefixo NEXT_PUBLIC_:\n   ✅ NEXT_PUBLIC_SUPABASE_URL\n   ✅ NEXT_PUBLIC_SUPABASE_ANON_KEY\n\n\uD83D\uDCCB Configure na Vercel: Settings → Environment Variables"):m("Erro ao fazer login: ".concat(s.message||"Por favor, verifique suas credenciais e tente novamente.")),p(!1);return}if(null==i?void 0:i.user){if(!i.user.email_confirmed_at&&!i.user.confirmed_at){await t.auth.signOut(),m("\uD83D\uDD12 Seu e-mail ainda n\xe3o foi confirmado.\n\n\uD83D\uDCE7 Por favor, verifique sua caixa de entrada e clique no link de confirma\xe7\xe3o enviado por email."),(0,d.h4)({type:"suspicious_activity",identifier:n,timestamp:Date.now(),details:{action:"login_attempt_unconfirmed_email",email:r}}),p(!1);return}(0,d.PO)(n),(0,d.h4)({type:"login_success",identifier:n,timestamp:Date.now()}),e.push("/dashboard")}}catch(e){console.error("Erro ao fazer login:",e),m("Erro inesperado. Por favor, tente novamente."),p(!1)}};return(0,r.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center px-4",children:(0,r.jsxs)("div",{className:"w-full max-w-md",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-emerald-400 to-green-500 rounded-xl mb-4",children:(0,r.jsx)("svg",{className:"w-8 h-8 text-black",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Bem-vindo de volta"}),(0,r.jsx)("p",{className:"text-white/60",children:"Fa\xe7a login para continuar"})]}),(0,r.jsxs)("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-6 border border-white/10",children:[(0,r.jsxs)("form",{onSubmit:h,className:"space-y-4",children:[c&&(0,r.jsx)("div",{className:"bg-red-500/10 border border-red-500/50 rounded-lg p-4 text-red-400 text-sm whitespace-pre-line",children:c}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-white/80 mb-2",children:"E-mail"}),(0,r.jsx)("input",{id:"email",type:"email",value:a.email,onChange:e=>o({...a,email:e.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-emerald-500",placeholder:"seu@email.com",required:!0,disabled:u})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-white/80 mb-2",children:"Senha"}),(0,r.jsx)("input",{id:"password",type:"password",value:a.password,onChange:e=>o({...a,password:e.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-emerald-500",placeholder:"••••••••",required:!0,disabled:u})]}),(0,r.jsx)("button",{type:"submit",disabled:u,className:"w-full py-3 bg-emerald-500 hover:bg-emerald-600 text-black font-semibold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Entrando...":"Entrar"})]}),(0,r.jsx)("div",{className:"mt-6 text-center",children:(0,r.jsxs)("p",{className:"text-white/60 text-sm",children:["N\xe3o tem uma conta?"," ",(0,r.jsx)(i(),{href:"/register",className:"text-emerald-400 hover:text-emerald-300 font-medium",children:"Criar conta"})]})})]})]})})}},7013:(e,t,a)=>{Promise.resolve().then(a.bind(a,5404))},8231:(e,t,a)=>{"use strict";a.d(t,{A_:()=>p,DT:()=>d,Eb:()=>o,Gg:()=>f,Hc:()=>x,Oj:()=>c,PO:()=>i,Zm:()=>l,aJ:()=>u,h4:()=>h,jZ:()=>s,yS:()=>m,zf:()=>v});let r=new Map,n={MAX_LOGIN_ATTEMPTS:5,BLOCK_DURATION_MINUTES:15,WINDOW_MINUTES:15,MAX_REQUESTS_PER_MINUTE:60,MAX_SIGNUP_PER_HOUR:5};function o(e,t){let a=Date.now(),o=r.get(e);if(!o)return r.set(e,{attempts:1,resetTime:a+60*n.WINDOW_MINUTES*1e3,blocked:!1}),{allowed:!0};if(o.blocked&&a<o.resetTime)return{allowed:!1,retryAfter:Math.ceil((o.resetTime-a)/1e3/60)};if(a>o.resetTime)return r.set(e,{attempts:1,resetTime:a+60*n.WINDOW_MINUTES*1e3,blocked:!1}),{allowed:!0};let i="login"===t?n.MAX_LOGIN_ATTEMPTS:"signup"===t?n.MAX_SIGNUP_PER_HOUR:n.MAX_REQUESTS_PER_MINUTE;return o.attempts>=i?(o.blocked=!0,o.resetTime=a+60*n.BLOCK_DURATION_MINUTES*1e3,{allowed:!1,retryAfter:n.BLOCK_DURATION_MINUTES}):(o.attempts++,{allowed:!0})}function i(e){r.delete(e)}function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4;if(!e||"string"!=typeof e)return"";let a=e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/javascript:/gi,"").replace(/on\w+=/gi,"").replace(/[\x00-\x1F\x7F]/g,"").trim();return a.length>t&&(a=a.substring(0,t)),a}function l(e){let t={...e};for(let e of["__proto__","constructor","prototype"])delete t[e];return t}setInterval(function(){let e=Date.now();for(let[t,a]of r.entries())e>a.resetTime&&!a.blocked&&r.delete(t)},18e5);let d=function(e){return!!e&&"string"==typeof e&&/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e)&&e.length<=254};function c(e){let t=[];if(!e||"string"!=typeof e)return{valid:!1,errors:["Senha \xe9 obrigat\xf3ria"],strength:"weak"};e.length<8&&t.push("Senha deve ter pelo menos 8 caracteres"),e.length>128&&t.push("Senha muito longa (m\xe1ximo 128 caracteres)");let a=/[A-Z]/.test(e),r=/[a-z]/.test(e),n=/\d/.test(e),o=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e);a||t.push("Senha deve conter pelo menos uma letra mai\xfascula"),r||t.push("Senha deve conter pelo menos uma letra min\xfascula"),n||t.push("Senha deve conter pelo menos um n\xfamero"),o||t.push("Senha deve conter pelo menos um caractere especial"),["password","12345678","qwerty","abc123","password123","admin","senha","123456","123456789","1234567890"].some(t=>e.toLowerCase().includes(t))&&t.push("Senha muito comum. Escolha uma senha mais segura");let i="weak",s=[a,r,n,o,e.length>=12].filter(Boolean).length;return s>=4&&e.length>=12?i="strong":s>=3&&(i="medium"),{valid:0===t.length,errors:t,strength:i}}function m(e){return e&&"string"==typeof e?e.length<2?{valid:!1,error:"Nome deve ter pelo menos 2 caracteres"}:e.length>100?{valid:!1,error:"Nome muito longo (m\xe1ximo 100 caracteres)"}:/^[a-zA-ZÀ-ÿ\u00f1\u00d1\s\-']+$/.test(e)?{valid:!0}:{valid:!1,error:"Nome cont\xe9m caracteres inv\xe1lidos"}:{valid:!1,error:"Nome \xe9 obrigat\xf3rio"}}function u(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e4;return e&&"string"==typeof e?e.length>t?{valid:!1,error:"Texto muito longo (m\xe1ximo ".concat(t," caracteres)")}:{valid:!0,sanitized:s(e,t)}:{valid:!1,error:"Texto \xe9 obrigat\xf3rio"}}function h(e){console.warn("\uD83D\uDD12 Security Event:",e)}function f(e){return e.size>0xa00000?{valid:!1,error:"Arquivo muito grande. Tamanho m\xe1ximo: ".concat(10,"MB")}:{valid:!0}}let g=["application/pdf","text/plain","text/markdown","text/x-markdown","text/html","text/csv","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"];function v(e){return g.includes(e.type)||e.name.toLowerCase().endsWith(".md")||e.name.toLowerCase().endsWith(".txt")||e.name.toLowerCase().endsWith(".csv")||e.name.toLowerCase().endsWith(".xlsx")||e.name.toLowerCase().endsWith(".xls")?{valid:!0}:{valid:!1,error:"Tipo de arquivo n\xe3o permitido. Use PDF, TXT, MD, HTML, CSV, XLSX, XLS, DOC ou DOCX."}}function x(e,t){return t?"".concat(e||"anonymous","_").concat(t):e||"anonymous"}},8525:(e,t,a)=>{"use strict";a.d(t,{U:()=>o});var r=a(6010),n=a(5704);function o(){let e=n.env.NEXT_PUBLIC_SUPABASE_URL,t=n.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;return e&&t||console.warn("⚠️ Vari\xe1veis de ambiente do Supabase n\xe3o configuradas. O cliente Supabase pode n\xe3o funcionar corretamente."),(0,r.createBrowserClient)(e||"",t||"",{db:{schema:"public"},auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},global:{headers:{"x-client-info":"labprompt-nextjs"}}})}}},e=>{e.O(0,[503,163,619,441,255,358],()=>e(e.s=7013)),_N_E=e.O()}]);